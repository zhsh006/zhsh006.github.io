<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>七星传</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="七星传">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="七星传">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="七星传" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 4.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">七星传</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-ChIP-Seq分析小实战（二）" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/06/10/ChIP-Seq%E5%88%86%E6%9E%90%E5%B0%8F%E5%AE%9E%E6%88%98%EF%BC%88%E4%BA%8C%EF%BC%89/" class="article-date">
  <time datetime="2020-06-09T18:40:58.000Z" itemprop="datePublished">2020-06-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/06/10/ChIP-Seq%E5%88%86%E6%9E%90%E5%B0%8F%E5%AE%9E%E6%88%98%EF%BC%88%E4%BA%8C%EF%BC%89/">ChIP-Seq分析小实战（二）</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>在ChIP-Seq分析小实战（一）中以将数据做好了准备，接着就是按照文章中所述将ChIP-seq数据用botwie比对至NCBIM37基因组上，但是这次我还是按照教程的方法，使用bowtie2比对至mm10基因组上</p>
<blockquote>
<p>The millions of reads produced by ChIP-seq of RYBP, Cbx7, Ring1B, Suz12,<br>and H2AK119Ub were aligned with the mouse genome (version NCBIM37)using the Bowtie (Langmead et al., 2009) tool version 0.12.7; two mismatches<br>were allowed within the seed alignment</p>
</blockquote>
<h4 id="Mapping-reads"><a href="#Mapping-reads" class="headerlink" title="Mapping reads"></a>Mapping reads</h4><p>由于用fastqc质控后，发现Ring1B、Suz12和IgG_old样本的3’端有大约5个bp长度的碱基质量不是太好（大概在Q25左右），按照原来是惯例应该用软件将其剪去，但是看了教程发现可以用bowtie2中的参数在比对时进行处理，去官网手册上查了下</p>
<p><code>-3/--trim3</code> Trim bases from 3’ (right) end of each read before alignment (default: 0)</p>
<p><code>--local</code> In this mode, Bowtie 2 does not require that the entire read align from one end to the other. Rather, some characters may be omitted (“soft clipped”) from the ends in order to achieve the greatest possible alignment score</p>
<p>其实我们在用bowtie2时默认是使用<code>--end-to-end</code>，但是其是要求 entire read align from one end to the other, without any trimming (or “soft clipping”) of characters from either end，所以在使用<code>-3/--trim3</code>参数时，需要再加个<code>--local</code>参数</p>
<p>即比对代码如下，由于机子较差，因此将样本一个个运行，写了简单的shell脚本，同时将比对结果输出到log文件中，然后用samtools将sam文件转化成bam文件，并排序</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#&#x2F;bin&#x2F;bashGENOME&#x3D;&#x2F;home&#x2F;anlan&#x2F;reference&#x2F;index&#x2F;bowtie2&#x2F;mm10&#x2F;mm10bowtie2 -p 5 --trim3 5 --local -x $GENOME -U SRR620204.fastq 2&gt; ring1B_bowtie2.log |samtools sort -O bam -@ 5 -o ring1B.bambowtie2 -p 5 --trim3 5 --local -x $GENOME -U SRR620205.fastq 2&gt; cbx7_bowtie2.log |samtools sort -O bam -@ 5 -o cbx7.bambowtie2 -p 5 --trim3 5 --local -x $GENOME -U SRR620206.fastq 2&gt; suz12_bowtie2.log |samtools sort -O bam -@ 5 -o suz12.bambowtie2 -p 5 --trim3 5 --local -x $GENOME -U SRR620207.fastq 2&gt; RYBP_bowtie2.log |samtools sort -O bam -@ 5 -o RYBP.bambowtie2 -p 5 --trim3 5 --local -x $GENOME -U SRR620208.fastq 2&gt; IgGold_bowtie2.log |samtools sort -O bam -@ 5 -o IgGold.bambowtie2 -p 5 --trim3 5 --local -x $GENOME -U SRR620209.fastq 2&gt; IgG_bowtie2.log |samtools sort -O bam -@ 5 -o IgG.bam</span><br></pre></td></tr></table></figure>

<p>从比对结果上来看，比对率均并不高，如ring1B_bowtie2.log</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">19687027 reads; of these:      19687027 (100.00%) were unpaired; of these:        7960096 (40.43%) aligned 0 times        8614711 (43.76%) aligned exactly 1 time        3112220 (15.81%) aligned &gt;1 times59.57% overall alignment rate</span><br></pre></td></tr></table></figure>

<p>最后别忘记对每个bam文件建索引，不然后续步骤会报错</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">samtools index ring1B.bam</span><br></pre></td></tr></table></figure>

<h4 id="Peak-calling"><a href="#Peak-calling" class="headerlink" title="Peak calling"></a>Peak calling</h4><p>Peak calling可以理解为寻找peak出现的位置，而这些位置可能是一些靶蛋白结合的位点，我们做ChIP-seq也就是为了研究捕获到的序列以及其差异。至于其peak calling的原理以及我接下来使用的MACS2软件的原理可以参照<a href="https://www.plob.org/article/7227.html" target="_blank" rel="noopener">Chip-seq处理流程</a>，本来想贴这篇文章作者的博客链接的，结果发现博客打不开了！看了这文章后，大概能了解一点其统计学的含义</p>
<p>软件的下载及安装，一看是python的软件，如果只是尝试使用，我一般选择bioconda安装（我已配置好了conda环境了）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda install -c bioconda macs2</span><br></pre></td></tr></table></figure>

<blockquote>
<p>如果报错：CondaHTTPError: HTTP 000 CONNECTION FAILED for url &lt;<a href="https://nanomirrors.tuna.tsinghua.edu.cn/anaconda/cloud/bioconda/linux-64/repodata.json/>" target="_blank" rel="noopener">https://nanomirrors.tuna.tsinghua.edu.cn/anaconda/cloud/bioconda/linux-64/repodata.json&gt;</a></p>
</blockquote>
<p>说明墙太高了，那么需要对conda的源文件进行点处理（前提你已经给canda添加了清华源后还报错）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim ~&#x2F;.condarc删除 - defaults 的行</span><br></pre></td></tr></table></figure>

<p>安装成功后就可以用macs2对每个bam文件进行call peaks了，简单看一下可能会用到的几个参数</p>
<ul>
<li>-t/–treatment 输入文件，支持很多格式，搭配-f/–format使用</li>
<li>-f/–format 设定输入文件的格式，这里我会选择bam格式</li>
<li>-c/–control 对照组（或者模拟的）数据，需要跟-t的输出文件在相同目录下</li>
<li>-n/–name 输出文件（有很多个文件）的前缀</li>
<li>–outdir 输出文件所在目录（不设定的话就默认当前目录了）</li>
<li>-g/–gsize 提供基因组的大小，程序有默认的几个物种可以选hs,mm,ce,dm</li>
<li>-q/–qvalue 设定FDR的阈值，默认是0.05</li>
<li>-p/–pvalue 设定pvalue的阈值，如果参数设定了-p，则其会覆盖参数-q的作用</li>
<li>-B/–bdg If this flag is on, MACS will store the fragment pileup, control lambda, -log10pvalue and -log10qvalue scores in bedGraph files.</li>
</ul>
<p>看到文章中有对macs2的软件参数的选择的</p>
<blockquote>
<p>Peaks with a FDR lower than 5% from Cbx7, Ring1B, Suz12, and H2AK119ub,<br>and lower than 1% from RYBP, were combined to detect chromosomal<br>regions for further analyses.</p>
</blockquote>
<blockquote>
<p>We observed an overlap of RYBP peaks (3,918 in<br>total) with 14%, 42%, and 37% of Cbx7, Ring1B, and Suz12<br>peaks, respectively (false discovery rate [FDR] = 1%; p = 1 3<br>10-5) (Figure 1A</p>
</blockquote>
<p>所以对每个样本的macs2代码如下（选择的对照组的bam文件为IgGold.bam，不太了解IgG.bam在文中的作用）:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">macs2 callpeak -c IgGold.bam -t suz12.bam -p 1e-5 -f BAM -g mm -n suz12 2&gt; suz12.macs2.logmacs2 callpeak -c IgGold.bam -t ring1B.bam -p 1e-5 -f BAM -g mm -n ring1B 2&gt; ring1B.macs2.logmacs2 callpeak -c IgGold.bam -t cbx7.bam -p 1e-5 -f BAM -g mm -n cbx7 2&gt; cbx7.macs2.logmacs2 callpeak -c IgGold.bam -t RYBP.bam -p 1e-5 -f BAM -g mm -n RYBP 2&gt;RYBP.macs2.log</span><br></pre></td></tr></table></figure>

<p>然后粗略看一下peak位置信息的文件，看看每个样本找到多少个peak（bed的格式，储存了每个peaks的位置信息）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wc -l *.bed</span><br></pre></td></tr></table></figure>

<blockquote>
<p>2198 cbx7_summits.bed<br>7072 ring1B_summits.bed<br>6872 RYBP_summits_2.bed<br>2 RYBP_summits.bed<br>6633 suz12_summits.bed</p>
</blockquote>
<p>回到文章中一看，cbx7、ring1B，RYBP和suz12对应的peaks number分别对应2754、6982、3918和8054。。除了RYBP相差的也太严重了，其他的样本也有点差别。RYBP样本肯定无法进行后续分析了，所以按照教程中所说的，从<a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE42466把RYBP样本的peaks文件下载下来用用" target="_blank" rel="noopener">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE42466把RYBP样本的peaks文件下载下来用用</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget ftp:&#x2F;&#x2F;ftp.ncbi.nlm.nih.gov&#x2F;geo&#x2F;series&#x2F;GSE42nnn&#x2F;GSE42466&#x2F;suppl&#x2F;GSE42466_RYBP_peaks_5.txt.gzgunzip GSE42466_RYBP_peaks_5.txt.gzmv GSE42466_RYBP_peaks_5.txt RYBP_summits.bed</span><br></pre></td></tr></table></figure>

<p>macs2 call peak出来各个文件的作用可以看官网介绍<a href="https://github.com/taoliu/MACS/" target="_blank" rel="noopener">https://github.com/taoliu/MACS/</a></p>
<ul>
<li>NAME_peaks.xls 包含called peaks的信息</li>
<li>NAME_peaks.narrowPeak is BED6+4 format file which contains the peak locations together with peak summit, pvalue and qvalue</li>
<li>NAME_summits.bed BED format, which contains the peak summits locations for every peaks.If you want to find the motifs at the binding sites, this file is recommended</li>
</ul>
<p>接下来应该就是对peaks进行注释，然后寻找其靶基因以及结合位点等</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/06/10/ChIP-Seq%E5%88%86%E6%9E%90%E5%B0%8F%E5%AE%9E%E6%88%98%EF%BC%88%E4%BA%8C%EF%BC%89/" data-id="ckb8a0z7u00001lhjgod972ia" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%BD%91%E7%BB%9C%E6%91%98%E6%8A%84/" rel="tag">网络摘抄</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-ChIP-Seq分析小实战（一）" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/06/10/ChIP-Seq%E5%88%86%E6%9E%90%E5%B0%8F%E5%AE%9E%E6%88%98%EF%BC%88%E4%B8%80%EF%BC%89/" class="article-date">
  <time datetime="2020-06-09T18:40:51.000Z" itemprop="datePublished">2020-06-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/06/10/ChIP-Seq%E5%88%86%E6%9E%90%E5%B0%8F%E5%AE%9E%E6%88%98%EF%BC%88%E4%B8%80%EF%BC%89/">ChIP-Seq分析小实战（一）</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="ChIP知识点的梳理"><a href="#ChIP知识点的梳理" class="headerlink" title="ChIP知识点的梳理"></a>ChIP知识点的梳理</h4><p>ChIP属于表观遗传学中的一门技术，我第一次了解表观遗传学是通过一本叫<strong>遗传的革命</strong>的科普书，但是对于ChIP相关名词并没有很好的理解，再加上之前从未接触过ChIP实验，所以这里首先对ChIP的一些知识点进行了整理，至少让自己能了解相关的名词的含义</p>
<p>ChIP-Seq是将ChIP(ChromatinImmunoprecipitation)与二代测序技术相结合的技术，能够高效地在全基因组范围内检测与组蛋白、转录因子等互作的DNA区域。ChIP也称为结合位点分析法，是研究体内蛋白质与DNA相互作用的有力工具，通常用于修饰组蛋白、转录因子、辅因子以及其他染色质蛋白在染色质上的定位及丰度研究。</p>
<ul>
<li><p>组蛋白修饰：</p>
<blockquote>
<p>组蛋白的概念：组蛋白是真核生物染色体的基本结构蛋白，是真核生物体细胞染色质中的碱性蛋白质，含精氨酸和赖氨酸等碱性氨基酸特别多，二者加起来约为所有氨基酸残基的1/4。组蛋白是一类小分子碱性蛋白质，有五种类型：H1、H2A、H2B、H3、H4，它们富含带正电荷的碱性氨基酸，能够同DNA中带负电荷的磷酸基团相互作用，因此两者吸附结合在一起，通过这种方式DNA的遗传信息被压缩</p>
</blockquote>
<blockquote>
<p>染色质的概念：染色体在细胞周期的间期时DNA的螺旋结构松散，呈网状或斑块状不定形物，即染色质。染色质是由许多核小体组成的，H2A，H2B，H3和H4各2个分子构成的8聚体是核小体的核心部分，H1的作用是与线形 DNA结合以帮助后者形成高级结构。每个蛋白都有伸出球形的松散折叠的氨基酸链，这就是所谓的组蛋白尾</p>
</blockquote>
<p>我们看到组蛋白H3K4me3这词，表示组蛋白H3肽链上的第四位赖氨酸有三个甲基化，其主要定位在转录活跃基因的启动子CpG岛上，这就告诉我们H3K4me3跟转录激活有关；组蛋白H3K27me3则主要定位在转录抑制的基因上，这就告诉我们H3K27me3跟转录抑制有关。</p>
<blockquote>
<p>组蛋白有两种常见修饰：乙酰化和甲基化，那么参与其修饰的酶则是乙酰化酶和甲基化酶，如果再分对修饰是促进还是抑制作用则包括甲基化酶和去甲基化酶、乙酰化酶和去乙酰化酶。一般把添加修饰的叫做writer，把去修饰的叫做eraser，还有一个reader能识别组蛋白上特定的化学修饰</p>
</blockquote>
<p>所以说这三类因子分别可以实现组蛋白各种修饰的添加、去除和识别，从而调控基因的转录，如：</p>
<p>组蛋白中的赖氨酸K（正电荷）被加上甲基化，导致正电荷变少，因此与DNA结合能力减弱，染色质从紧密变成松散，这样转录因子才能结合到DNA中，说明了组蛋白修饰是调控染色质紧密程度的关键因素之一。当然乙酰基的加入，也能改变了组蛋白和DNA结合的能力，有利于基因表达</p>
<p>H3K4me3的reader，可以招募相应的writer SETD1对DNA进行甲基化修饰。又如bromo domain（属于reader），含有这类domain的蛋白家族通常能够识别组蛋白上经过修饰的赖氨酸，可以调控基因转录活性。有时组蛋白修饰会吸引reader以及其他蛋白（合作蛋白）在染色体上形成一个复合体，然后再对DNA特定区域进行甲基化修饰，这些修饰又与转录的激活和抑制有关。通常这些是跟甲基化有关？由于每一类组蛋白甲基化都能被高度分化的蛋白质通过赖氨酸-甲基识别？</p>
</li>
<li><p>转录因子：</p>
<blockquote>
<p>转录因子的概念：转录因子（transcription factor）是一群能与基因5’端上特定序列专一性结合，从而保证目的基因以特定的强度在特定的时间与空间来表达蛋白质分子</p>
</blockquote>
<blockquote>
<p>转录因子结合位点的概念：转录因子的结合位点（transcription factor binding site，TFBS）是转录因子调节基因表达时，与基因模板链结合的区域。按照常识，转录因子（TF）的结合位点一般应该分布在基因的前端。但是新的研究发现，人的21和22号染色体上，只有22%的转录因子结合位点分布在蛋白编码基因的5’端</p>
</blockquote>
<p>如果我们知道某种转录因子定位在哪些基因的启动子上，我们就可以知道，这个转录因子调控哪些基因表达。而丰度的多少可以提示这种转录因子对不同基因的调控强度。</p>
<p>对于一个样品，我们看结合位点所在的区域分布与已知的表观遗传学标记之间的关系；对于多个样品，在不同样品之间进行差异调控的基因（Differentially regulated gene，DRE）分析，得到样品间的差异</p>
</li>
<li><p>ChIP-Seq的原理是：</p>
<ol>
<li>通过甲醛将染色质上的DNA和蛋白交联结合在一起</li>
<li>通过超声或酶解的方法将染色质片段化</li>
<li>通过附上抗体的磁珠免疫沉淀靶蛋白</li>
<li>通过加热解除DNA和靶蛋白的交联</li>
<li>通过蛋白酶和RNA酶去除靶蛋白和RNA后，纯化DNA</li>
<li>通过PCA检测目标区域的DAN是否被靶蛋白富集到，然后再进行测序每做一次实验，换一个蛋白，所捕获的序列是不一样的。</li>
</ol>
</li>
</ul>
<p>ChIP-seq的实验对照：</p>
<p>我们做ChIP-Seq的时候需要使用control（通常使用IgG和input两种control结合）,以去除背景，确保之后的peak分析得到的peak是蛋白特异结合而不是因为甲醛交联或者抗体非特异性结合等情况所产生。</p>
<p>如果实验设计中有Input样本，那么Input和IP样本在前期检测、建库、测序都是平行进行的，但是分析中需要将两个样本的测序数据进行整合分析，得出最终的peak结果，并用于后续分析。</p>
<p>阴性对照：</p>
<ol>
<li>什么是input：样本经过超声，但是没有进行ChIP，包含样本超声后总DNA，开头进行的电泳，检测超声效果，同时，可以与最后ChIP样本进行比较，判断ChIP的效率（如果用同一引物进行PCR，ChIP组和input组亮度差不多，说明ChIP效率高，样本中所有的目的基因片段都被ChIP下来了，繁殖，说明效率低，实验条件有待改进）</li>
<li>什么是IgG：用普通的IgG做为抗体，理论上不会ChIP下来任何DNA片段，但是由于非特异结合，或者实验过程中，没有发生结合的DNA清除不完全，可能也会出现条带。</li>
</ol>
<p>阳性对照：</p>
<p>一般用anti-RNA polymerase II抗体，因为RNA polymerase II是通用转录因子，在所有细胞中都能结合基因的核心启动子区，因此理论上，ChIP后PCR会有条带。一般阳性对照不进行测序。</p>
<p>ChIP-seq基本名词解释（摘抄自网上）：</p>
<ol>
<li>Peak（峰）：由于超声打断的随机性，所以包含某个位的超声片段可能有多条，相互间起止点不同，这些片段被富集，片段间的重叠区域称为“峰”，即DNA与蛋白相互结合的位点。为了剔除假阳性，以没有经过免疫沉淀的超声样品（也就是input）作为负对照。</li>
<li>峰型：不同的DNA结合蛋白在基因组上的分布模式是不同的，具体体现于ChIP-seq峰形的不同。转录因子的峰型：尖锐状（sharp peak，即信号高度集中）；组蛋白标记的峰型：连绵状（broad peak，信号跨越一定范围）；RNA聚合酶II峰型：上述两者兼有。</li>
<li>TFBSs (Transcription factor binding sites)：转录因子结合位点通常是指基因组上，供转录因子结合的5-14bp的DNA序列</li>
<li>motif：转录因子与被调控基因是多对多的关系，一个转录因子可以识别相似的TFBSs ，这些TFBSs通常可以一个module表示，即motif</li>
<li>cis-regulatory module (CRM)：真核生物中，多个TFBSs往往集中于一段短DNA序列 (长度一般不超过200pb)中，该序列称为CRM</li>
</ol>
<h4 id="文章研究对象"><a href="#文章研究对象" class="headerlink" title="文章研究对象"></a>文章研究对象</h4><p>本文主要讲了PRC1(Polycomb repressive complex 1)在小鼠的胚胎干细胞中有两类亚型Cbx7-PRC1和RYBP-PRC1，但是Cbx7和RYBP这两种是不能共存的，尽管两者的全基因组定位在某些gene上交叉，也就是说在基因组上结合在了同一个位置。在分子水平上，Cbx7用于招募Ring1B结合到染色质上，然而RYBP可以增强PRC1的酶活性。RYBP结合的基因，其有着了较低水平的Ring1B和H2AK119ub，但其相比结合Cbx7有较高的表达量。在功能上，RYBP结合的基因主要涉及代谢调节和细胞周期，Cbx7结合的基因主要涉及early-lineage commitment of ESCs。</p>
<p>在做出上述总结前，肯定需要对PRC1进行介绍，其组成看起来非常复杂：</p>
<blockquote>
<p>The protein families that constitute the core of PRC1 contain several members:<br>Cbx (Cbx2, Cbx4, Cbx6, Cbx7, or Cbx8); Ring1A or Ring1B;<br>PHC (PHC1, PHC2, or PHC3); PCGF (PCGF1, PCGF2, PCGF3,<br>PCGF4, PCGF5, or PCGF6); and RYBP or YAF2.</p>
</blockquote>
<p>接着作者抛出自己这篇文章想要说明的问题：</p>
<blockquote>
<ul>
<li>What is the genome-wide localization of these two types of<br>PCR1 complexes?</li>
</ul>
</blockquote>
<ul>
<li>Is the expression of specific sets of genes differentially regulated by both complexes?</li>
<li>Do they exert common and/or unique biological functions?</li>
<li>Do they show any interdependency for localizing to chromatin?</li>
</ul>
<p>接着就是对各个结论进行表述及说明，这个在后续分析时再说</p>
<p>我们需要先拿到这篇文章所用的ChIP-seq数据，如下：</p>
<blockquote>
<p>Sequencing data have been deposited into the NCBI Gene Expression<br>Omnibus database under accession number GSE42466</p>
</blockquote>
<p>所以我们通过<a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE42466网页下方的ftp进行下载界面" target="_blank" rel="noopener">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE42466网页下方的ftp进行下载界面</a></p>
<p>ChIP-seq数据有SRR620204到SRR620209总共6个文件，每个文件的对应是样本Ring1B、Cbx7、Suz12、RYBP、IgG_old和IgG。bx7、Ring1B、RYBP是复合体的组成，外加PRC2的Suz12以及2个对照组</p>
<h4 id="数据的下载和整理"><a href="#数据的下载和整理" class="headerlink" title="数据的下载和整理"></a>数据的下载和整理</h4><p>以SRR620204.sra为例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ascp -T -i &#x2F;home&#x2F;anlan&#x2F;.aspera&#x2F;connect&#x2F;etc&#x2F;asperaweb_id_dsa.openssh anonftp@ftp-private.ncbi.nlm.nih.gov:sra&#x2F;sra-instant&#x2F;reads&#x2F;ByStudy&#x2F;sra&#x2F;SRP&#x2F;SRP017&#x2F;SRP017311&#x2F;SRR620204&#x2F;SRR620204.sra</span><br></pre></td></tr></table></figure>

<p>转化为fq格式，检查质控fastqc</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">for i in $(seq 4 9);do fastq-dump --split-3 SRR62020$&#123;i&#125;.sra ;donefastqc SRR62020*.fastqmultiqc SRR62020*</span><br></pre></td></tr></table></figure>

<p>由于使用bowtie2软件将reads比对至参考基因组上，所以要下载Bowtie2的mm10的索引</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget ftp://ftp.ccb.jhu.edu/pub/data/bowtie2_indexes/mm10.zip</span><br></pre></td></tr></table></figure>

<p>最后需要mm10 refseq注释bed文件，进行网址下载<a href="http://genome.ucsc.edu/cgi-bin/hgTables，其中track和table选择RefSeq，然后输出格式为bed即可，最后下载（可以先在自己电脑上下载再传到服务器上，也可以像下面直接在服务器上下载）" target="_blank" rel="noopener">http://genome.ucsc.edu/cgi-bin/hgTables，其中track和table选择RefSeq，然后输出格式为bed即可，最后下载（可以先在自己电脑上下载再传到服务器上，也可以像下面直接在服务器上下载）</a></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl 'http://genome.ucsc.edu/cgi-bin/hgTables?hgsid=646311755_P0RcOBvAQnWZSzQz2fQfBiPPSBen&amp;amp;boolshad.hgta_printCustomTrackHeaders=0&amp;amp;hgta_ctName=tb_ncbiRefSeq&amp;amp;hgta_ctDesc=table+browser+query+on+ncbiRefSeq&amp;amp;hgta_ctVis=pack&amp;amp;hgta_ctUrl=&amp;amp;fbQual=whole&amp;amp;fbUpBases=200&amp;amp;fbExonBases=0&amp;amp;fbIntronBases=0&amp;amp;fbDownBases=200&amp;amp;hgta_doGetBed=get+BED' &amp;gt;mm10.refseq.bed</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/06/10/ChIP-Seq%E5%88%86%E6%9E%90%E5%B0%8F%E5%AE%9E%E6%88%98%EF%BC%88%E4%B8%80%EF%BC%89/" data-id="ckb8a0z8300051lhj76abfn89" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%BD%91%E7%BB%9C%E6%91%98%E6%8A%84/" rel="tag">网络摘抄</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-BETA软件的整合Chip-seq和RNA-seq" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/06/10/BETA%E8%BD%AF%E4%BB%B6%E7%9A%84%E6%95%B4%E5%90%88Chip-seq%E5%92%8CRNA-seq/" class="article-date">
  <time datetime="2020-06-09T18:40:36.000Z" itemprop="datePublished">2020-06-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/06/10/BETA%E8%BD%AF%E4%BB%B6%E7%9A%84%E6%95%B4%E5%90%88Chip-seq%E5%92%8CRNA-seq/">BETA软件的整合Chip-seq和RNA-seq</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>####这是一个大课程的一部分，是<em><a href="http://bioinformatics.sph.harvard.edu/" target="_blank" rel="noopener">哈佛大学生物信息学核心（HBC）</a>的教学团队开发</em></p>
<p>外国许多培训都是免费的，而且知识点很全面，代码很新。</p>
<table>
<thead>
<tr>
<th>title</th>
<th>author</th>
<th>date</th>
</tr>
</thead>
<tbody><tr>
<td>Integrating RNA-seq and ChIP-seq</td>
<td>Meeta Mistry</td>
<td>June 29th, 2017</td>
</tr>
</tbody></table>
<h2 id="Integrating-RNA-seq-and-ChIP-seq"><a href="#Integrating-RNA-seq-and-ChIP-seq" class="headerlink" title="Integrating RNA-seq and ChIP-seq"></a>Integrating RNA-seq and ChIP-seq</h2><p>As discussed previously, cells use a wide range of mechanisms to regulate gene expression. The increase or decrease in production of specific gene products is dependent on sophisticated programs/machinery, which can change in different cellular conditions.</p>
<p>Evaluating the amount of up- and down-regulation of gene, was something that we explored during the RNA-seq sessions. In this ChIP-seq session, we discussed the machinery regulating expression, specifically in the context of transcription factors and chromatin regulators. It is very common to run both of these types of experiments and integrate data from each to derive a better understanding at the molecular level. However, there are not alot of sophisticated methods developed to compae the two types of data in a robust manner.</p>
<h3 id="Direct-comparisons"><a href="#Direct-comparisons" class="headerlink" title="Direct comparisons"></a>Direct comparisons</h3><p>Typically in the literature, one will find studies in which the RNA-seq and ChIP-seq were performed independently and then differntially expressed genes were compared with target genes from the ChIP-seq using a simple overlap measure. These overlapping statistics are complemented with a figure focussing on a panel of select genes. For these genes binding evidence is displayed (using bigWig tracks and/or density profile plots) and a plot of expression changes taken from the RNA-seq data next to it.</p>
<p><a href="https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/blob/master/sessionV/img/rna-chip.png" target="_blank" rel="noopener"><img src="https://zhsh006-1257137335.cos.ap-chengdu.myqcloud.com/2020-06-09-184409.png" alt="img"></a></p>
<blockquote>
<p>This was taken from Gao et. al, Nature 2014, where they investigated the AUTS2 protein, risk factor for ASD and other neurological disorders and its link with PRC1, a key epigenetic regulator.</p>
</blockquote>
<h3 id="BETA-Binding-and-Expression-Target-Analysis"><a href="#BETA-Binding-and-Expression-Target-Analysis" class="headerlink" title="BETA (Binding and Expression Target Analysis)"></a>BETA (Binding and Expression Target Analysis)</h3><p>An another alternative is a tool called <a href="http://cistrome.org/BETA/" target="_blank" rel="noopener">BETA</a> from Shirley Liu’s lab at HMS. BETA is a software package that integrates ChIP-seq of transcription factors or chromatin regulators with differential gene expression data to infer direct target genes. This tool stands out from the other nearest gene analyses as it has potential to find target genes for proteins that bind enhancer regions.</p>
<p>BETA has <strong>three functions</strong>:</p>
<ol>
<li>to predict whether the factor has activating or repressive function</li>
<li>to infer the factor’s target genes</li>
<li>to identify the motif of the factor and its collaborators which might modulate the factor’s activating or repressive function.</li>
</ol>
<p>It has three commands depending on what input data you have and what output you desire.</p>
<ul>
<li>BETA <strong>basic</strong>: TF activating and repressive function prediction and direct targets detecting</li>
<li>BETA <strong>plus</strong>: BETA basic + motif analysis on target regions</li>
<li>BETA <strong>minus</strong>: TF target genes prediction based on regulatory potential score with only binding data</li>
</ul>
<p><a href="https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/blob/master/sessionV/img/beta.png" target="_blank" rel="noopener"><img src="https://zhsh006-1257137335.cos.ap-chengdu.myqcloud.com/2020-06-09-184410.png" alt="img"></a></p>
<p><strong>Image source: Nat Protoc. 2013 Dec; 8(12): 2502–2515.</strong></p>
<blockquote>
<p><em>NOTE: BETA is available as a module on Orchestra.</em></p>
</blockquote>
<h4 id="How-does-it-work"><a href="#How-does-it-work" class="headerlink" title="How does it work?"></a>How does it work?</h4><ul>
<li>For each gene a <strong>regulatory potential (RP)</strong> value is computed by taking all binding sites within the specified range of gene TSS (i.e 100kb)</li>
<li>RP is a gene’s likelihood of being regulated by a factor, and is dependent on the number of sites withing range of the TSS and the distance between the binding site and TSS.</li>
<li><strong>BETA minus</strong> will rank genes by the RP value to identify targets.</li>
<li><strong>BETA basic</strong> will require your DE analysis results in a specific format and knowledge of which are significant. It uses a CDF to determine whether the UP and DOWN groups differ from NON-DE. This is used to identify activating and repressive function. For each gene a rank product score is computed using your RP and DE statistic. This rank product is the new score to identify targets.</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/06/10/BETA%E8%BD%AF%E4%BB%B6%E7%9A%84%E6%95%B4%E5%90%88Chip-seq%E5%92%8CRNA-seq/" data-id="ckb8a0z8000011lhj3apm16ud" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%BD%91%E7%BB%9C%E6%91%98%E6%8A%84/" rel="tag">网络摘抄</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-siRNA作用方式" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/06/10/siRNA%E4%BD%9C%E7%94%A8%E6%96%B9%E5%BC%8F/" class="article-date">
  <time datetime="2020-06-09T18:40:21.000Z" itemprop="datePublished">2020-06-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/06/10/siRNA%E4%BD%9C%E7%94%A8%E6%96%B9%E5%BC%8F/">siRNA作用方式</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="https://zhsh006-1257137335.cos.ap-chengdu.myqcloud.com/2020-06-09-184346.jpg" alt="“siRNA”的图片搜索结果"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/06/10/siRNA%E4%BD%9C%E7%94%A8%E6%96%B9%E5%BC%8F/" data-id="ckb8a0z89000d1lhj5p613qhq" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%BD%91%E7%BB%9C%E6%91%98%E6%8A%84/" rel="tag">网络摘抄</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-比对带有genename" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/06/10/%E6%AF%94%E5%AF%B9%E5%B8%A6%E6%9C%89genename/" class="article-date">
  <time datetime="2020-06-09T18:40:14.000Z" itemprop="datePublished">2020-06-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/06/10/%E6%AF%94%E5%AF%B9%E5%B8%A6%E6%9C%89genename/">比对带有genename</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>featureCounts -T 30 -t exon –extraAttributes gene_name -g gene_id -a /home/zetter/data/Database/public/gtf/Rattus_norvegicus.Rnor_6.0.97.gtf.gz  -o ~/data/Database/Rearch_Group/Hippo/3.counts/all.info.txt ~/data/Database/Rearch_Group/Hippo/2.mapping/*.sort.bam</p>
<p>带多个类型，比如gene_name, gene_biotype</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">featureCounts -T 30 -t exon --extraAttributes gene_name,gene_biotype -g gene_id -a &#x2F;home&#x2F;zetter&#x2F;data&#x2F;Database&#x2F;public&#x2F;gtf&#x2F;Rattus_norvegicus.Rnor_6.0.97.gtf.gz  -o ~&#x2F;data&#x2F;Database&#x2F;Rearch_Group&#x2F;Hippo&#x2F;3.counts&#x2F;allinfo2.txt ~&#x2F;data&#x2F;Database&#x2F;Rearch_Group&#x2F;Hippo&#x2F;2.mapping&#x2F;*.sort.bam</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ol>
<li><code>library(ggplot2)</code></li>
<li><code>library(ggrepel)</code></li>
<li><code>data &lt;- qlf.2vs1$table</code></li>
<li><code>data$significant &lt;- as.factor(data$PValue&lt;0.05 &amp; abs(data$logFC) &gt; 1)</code></li>
<li></li>
<li><code>data2 &lt;- data[intersect_gene,]</code></li>
<li><code>data2$geneID &lt;- rownames(data2)</code></li>
<li></li>
<li></li>
<li><code>p &lt;- ggplot(data=data, aes(x=logFC, y =-log10(PValue),color=significant)) +</code></li>
<li><code>geom_point(alpha=0.8, size=1.2)+</code></li>
<li><code>scale_color_manual(values =c(&quot;black&quot;,&quot;red&quot;))+</code></li>
<li><code>labs(title=&quot;Volcanoplot&quot;, x=&quot;log2 (fold change)&quot;,y=&quot;-log10 (q-value)&quot;)+</code></li>
<li><code>theme(plot.title = element_text(hjust = 0.4))+</code></li>
<li><code>geom_hline(yintercept = -log10(0.05),lty=4,lwd=0.6,alpha=0.8)+</code></li>
<li><code>geom_vline(xintercept = c(1,-1),lty=4,lwd=0.6,alpha=0.8)+</code></li>
<li><code>#theme(legend.position=&#39;none&#39;)</code></li>
<li><code>theme_bw()+</code></li>
<li><code>theme(panel.border = element_blank(),</code></li>
<li><code>panel.grid.major = element_blank(),</code></li>
<li><code>panel.grid.minor = element_blank(),</code></li>
<li><code>axis.line = element_line(colour = &quot;black&quot;)) +</code></li>
<li><code>geom_text(data=data2, aes(label=geneID),col=&quot;red&quot;,alpha = 1) +</code></li>
<li><code>geom_text_repel(data=data2, aes(label=geneID),col=&quot;black&quot;,alpha = 0.8)</code></li>
<li></li>
<li><code>print(p)</code></li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/06/10/%E6%AF%94%E5%AF%B9%E5%B8%A6%E6%9C%89genename/" data-id="ckb8a0z8500091lhj7n9e5iwj" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux%E8%BD%AF%E4%BB%B6/" rel="tag">Linux软件</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-通过全基因组组蛋白H3K27乙酰化的特征分析小鼠饮食诱导的肥胖症中胰腺β细胞中的脂肪酸信号传导" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/06/10/%E9%80%9A%E8%BF%87%E5%85%A8%E5%9F%BA%E5%9B%A0%E7%BB%84%E7%BB%84%E8%9B%8B%E7%99%BDH3K27%E4%B9%99%E9%85%B0%E5%8C%96%E7%9A%84%E7%89%B9%E5%BE%81%E5%88%86%E6%9E%90%E5%B0%8F%E9%BC%A0%E9%A5%AE%E9%A3%9F%E8%AF%B1%E5%AF%BC%E7%9A%84%E8%82%A5%E8%83%96%E7%97%87%E4%B8%AD%E8%83%B0%E8%85%BA%CE%B2%E7%BB%86%E8%83%9E%E4%B8%AD%E7%9A%84%E8%84%82%E8%82%AA%E9%85%B8%E4%BF%A1%E5%8F%B7%E4%BC%A0%E5%AF%BC/" class="article-date">
  <time datetime="2020-06-09T18:35:28.000Z" itemprop="datePublished">2020-06-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/06/10/%E9%80%9A%E8%BF%87%E5%85%A8%E5%9F%BA%E5%9B%A0%E7%BB%84%E7%BB%84%E8%9B%8B%E7%99%BDH3K27%E4%B9%99%E9%85%B0%E5%8C%96%E7%9A%84%E7%89%B9%E5%BE%81%E5%88%86%E6%9E%90%E5%B0%8F%E9%BC%A0%E9%A5%AE%E9%A3%9F%E8%AF%B1%E5%AF%BC%E7%9A%84%E8%82%A5%E8%83%96%E7%97%87%E4%B8%AD%E8%83%B0%E8%85%BA%CE%B2%E7%BB%86%E8%83%9E%E4%B8%AD%E7%9A%84%E8%84%82%E8%82%AA%E9%85%B8%E4%BF%A1%E5%8F%B7%E4%BC%A0%E5%AF%BC/">通过全基因组组蛋白H3K27乙酰化的特征分析小鼠饮食诱导的肥胖症中胰腺β细胞中的脂肪酸信号传导</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>##DIABETOLOGIA：通过全基因组组蛋白H3K27乙酰化的特征分析小鼠饮食诱导的肥胖症中胰腺β细胞中的脂肪酸信号传导</p>
<p>研究表明，肥胖和2型糖尿病的发病机理受到表观遗传的调控。然而，关于其的详细信息尚不清楚，例如在胰腺细胞中调节环境影响的关键转录因子。</p>
<p>在本研究中，为了分析源自饮食诱导的肥胖（DIO）小鼠模型的胰岛的全基因组<em>顺式</em>调节谱和转录组，研究人员进行了染色质沉淀以及组蛋白H3赖氨酸27乙酰化的高通量测序（（ChIP-Seq）（组蛋白） H3K27ac）和高通量RNA测序。通过<strong>从头基序分析</strong>检查富含差异H3K27ac区域的转录因子结合基序。对于预测的转录因子，通过含有及不含有棕榈酸盐处理的INS-1（大鼠β细胞系）中转染特异性siRNA来进行功能敲除实验。通过ChIP和定量RT-PCR评估可能的靶基因的表观基因组和转录变化。</p>
<p>结果显示，在长期喂食高脂肪饮食后，C57BL/ 6J小鼠肥胖且出现轻度葡萄糖不耐受。在其中39,350个胰岛<em>顺式</em>- 调节区域，分别有13,369和4610元件显示ChIP-Seq信号的增加和减少，这与基因表达的全局变化显著相关。值得注意的是，增加的H3K27ac显示出独特的基因组定位，主要在近端启动子区域，通过de novo motif分析揭示位核呼吸因子1（NRF1），GA重复结合蛋白α（GABPA）和肌细胞增强因子2A（MEF2A）的富集元素。而减少的H3K27ac在v-maf肌肉腱膜纤维肉瘤癌基因家族蛋白K（MAFK）（一种已知的β细胞负调节因子）富集。通过siRNA对NRF1，GABPA或MEF2A的敲低，发现INS-1细胞表现出脂肪酸β-氧化基因的下调，与H3K27ac的减少同时发生。此外，与DIO小鼠中的表观基因组一致，棕榈酸处理引起H3K27ac增加和β-氧化基因的诱导; 当NRF1，GABPA或MEF2A被抑制时，这些反应不灵敏。</p>
<p>这些结果表明DNA结合蛋白和脂肪酸信号在肥胖诱导的β细胞功能的表观基因组调节中的新作用。</p>
<p>原始出处：Takao Nammo,[ Genome-wide profiling of histone H3K27 acetylation featured fatty acid signalling in pancreatic beta cells in diet-induced obesity in mice]</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/06/10/%E9%80%9A%E8%BF%87%E5%85%A8%E5%9F%BA%E5%9B%A0%E7%BB%84%E7%BB%84%E8%9B%8B%E7%99%BDH3K27%E4%B9%99%E9%85%B0%E5%8C%96%E7%9A%84%E7%89%B9%E5%BE%81%E5%88%86%E6%9E%90%E5%B0%8F%E9%BC%A0%E9%A5%AE%E9%A3%9F%E8%AF%B1%E5%AF%BC%E7%9A%84%E8%82%A5%E8%83%96%E7%97%87%E4%B8%AD%E8%83%B0%E8%85%BA%CE%B2%E7%BB%86%E8%83%9E%E4%B8%AD%E7%9A%84%E8%84%82%E8%82%AA%E9%85%B8%E4%BF%A1%E5%8F%B7%E4%BC%A0%E5%AF%BC/" data-id="ckb8a0z8b000h1lhj7zr1bk5w" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%BD%91%E7%BB%9C%E6%91%98%E6%8A%84/" rel="tag">网络摘抄</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-fastq文件详解" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/06/10/fastq%E6%96%87%E4%BB%B6%E8%AF%A6%E8%A7%A3/" class="article-date">
  <time datetime="2020-06-09T18:35:20.000Z" itemprop="datePublished">2020-06-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/06/10/fastq%E6%96%87%E4%BB%B6%E8%AF%A6%E8%A7%A3/">fastq文件详解</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>从计算机的角度来说，生物的序列属于一种字符串，也是一种文本，因此生物信息分析属于文本处理范畴。文本存储为固定格式文件，生物信息的工作就是各种文本文件之间格式的转换，例如通过序列拼接将fastq转换为fasta，通过短序列比对将fastq与fasta合并为bam，通过变异检测将bam中突变位点提取出来转换为vcf。因此，我们可以通过总结每一种生物数据文件格式的处理方法来学习生物信息，这样当拿到固定格式的文件之后，就知道该如何来处理了。</p>
</blockquote>
<p><img src="https://zhsh006-1257137335.cos.ap-chengdu.myqcloud.com/2020-06-09-183829.png" alt="image-20191221044407257"></p>
<p>fastq格式是一种包含质量值的序列文件，其中的q为quality,一般用来存储原始测序数据，扩展名一般为fastq或者fq。目前illumina测序，BGISEQ，Ion Torrent，pacbio，nanopore都以fastq格式存储测序数据，其中illumina，BGISEQ一般是双末端测序，一般是一对文件，命名为<strong>_R1.fq.gz与</strong>_R2.fq.gz。下面是fastq格式常见的序列格式。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@FCD056DACXX:3:1101:2163:1959#TCGCCGTG&#x2F;1TCCGATAACGCTCAACCAGAGGGCTGCCAGCTCCGATCGGCAGTTGCAACCCATTGGCCGTCTGAGCCAGCAACCCCGGA+gggiiiiiiiiiiiiiiiiiiiiiiiiiigggggeeecccccc^bcbcccccccbccccc]aaccbbccc^R^^acccc_@FCD056DACXX:3:1101:2194:1984#TCGCCGTG&#x2F;1AGACGACGACTTCGTTTCCCGCCGCGAGTTGCGCCATGATCGCGGTGTGCAGATTCGTTACGCCCTGGGCCACGGAGACG+gggiihiiiiiiiihiiiiiiiiiigeccccccccccccccccccaccccdcccccccccccacc_accccccccccV^^</span><br></pre></td></tr></table></figure>

<p>第一行：以‘@’开头，是这一条read的名字，这个字符串是根据测序时的状态信息转换过来的，中间不会有空格，它是每一条read的唯一标识符，同一份FASTQ文件中不会重复出现，甚至不同的FASTQ文件里也不会有重复；<br>第二行：测序read的序列，由A，C，G，T和N这五种字母构成，这也是我们真正关心的DNA序列，N代表的是测序时那些无法被识别出来的碱基；<br>第三行：以’+’开头，在旧版的FASTQ文件中会直接重复第一行的信息，但现在一般什么也不加（节省存储空间）；<br>第四行：测序read的质量值，这个和第二行的碱基信息一样重要，它描述的是每个测序碱基的可靠程度，用ASCII码表示。</p>
<p>质量值</p>
<p>上面提到fastq格式中的q代表质量值，因此fastq格式中质量值具有重要的作用，在很多的分析中会用到这个质量值，例如数据质控，数据过滤，序列拼接，短序列比对，变异检测中都要用到这个质量值。<br>这个质量值是基于phred质量值体系，但是由于单个碱基无法与两位的质量值相匹配，例如A碱基对应的质量值为40，一个A字符对应两个字符40，因此需要将原始质量值加上33或者64，在转换为对应的ASCII码值，为何加33，因为33以下ASCII码无法用键盘字符表示出来。illumina测序1.8版本以上加33，以下加64。</p>
<p><img src="https://zhsh006-1257137335.cos.ap-chengdu.myqcloud.com/2020-06-09-183830.png" alt="image-20191221044515183"></p>
<p>获取fastq文件</p>
<p>可以直接拿DNA，选择合适的测序方式，就可以得到fastq格式文件，无论人，动物，植物，微生物，测序的是全基因组，还是外显子，捕获序列，抑或是RNA样本，FFPE样本最终得到的都是fatsq格式文件。注意，有些平台得到的是两个文件，reads1与reads2，有些平台得到的是一个文件。如何自己没有测序，也可以在NCBI SRA数据库下载测序文件，使用sratools工具中的prefetch或者fastq-dump软件都可以下载fastq文件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">prefetch SRR8651554</span><br></pre></td></tr></table></figure>

<p>将sra转为为fastq</p>
<p>利用fastq-dump文件可以将sra文件直接转换为fastq格式，注意，如果是illumina的双末端测序，需要添加 –split-files选项，如果需要压缩格式，需要添加 –gzip选项。最终会生成SRR8651554_1.fastq.gz，SRR8651554_2.fastq.gz两个文件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fastq-dump --split-files --gzip ~&#x2F;ncbi&#x2F;public&#x2F;sra&#x2F;SRR8651554.sra</span><br></pre></td></tr></table></figure>

<p>压缩与解压缩</p>
<p>目前绝大部分的软件都可以直接处理压缩格式，因此一般的fastq格式都是压缩格式呈现的，扩展名为fq.gz，如果需要压缩或者解压缩可以使用以下命令。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#解压缩</span><br><span class="line">gunzip SRR8651554_1.fastq.gz</span><br><span class="line">gzip -d  SRR8651554_2.fastq.gz</span><br><span class="line">#压缩</span><br><span class="line">gzip SRR8651554_1.fastq</span><br><span class="line">gzip SRR8651554_2.fastq</span><br></pre></td></tr></table></figure>

<p>未完待续……</p>
<p>———- END ———-</p>
<blockquote>
<p>从计算机的角度来说，生物的序列属于一种字符串，也是一种文本，因此生物信息分析属于文本处理范畴。文本存储为固定格式文件，生物信息的工作就是各种文本文件之间格式的转换，例如通过序列拼接将fastq转换为fasta，通过短序列比对将fastq与fasta合并为bam，通过变异检测将bam中突变位点提取出来转换为vcf。因此，我们可以通过总结每一种生物数据文件格式的处理方法来学习生物信息，这样当拿到固定格式的文件之后，就知道该如何来处理了。</p>
</blockquote>
<p>完整性校验</p>
<p>完整性检验主要是为了保证文件在传输过程中保持完整，没有丢失内容，一般采用md5校验方式，目前测序公司给定的测序数据都带有md5文件，这样文件就是用来校验数据完整性的。可以使用md5sum -c命令检测这个文件，如果返回OK，说明文件完整。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">md5sum -c SRR8651554_1.fastq.md5md5sum -c SRR8651554_5.fastq.md5</span><br></pre></td></tr></table></figure>

<p>fastq文件统计</p>
<p>如果想对fastq文件进行统计，例如统计序列条数，碱基总数，reads读长分布等，可以使用seqkit工具进行操作。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ seqkit stats SRR8651554_1.fastq.gz SRR8651554_2.fastq.gz</span><br><span class="line">file                   format  type   num_seqs      sum_len  min_len  avg_len  max_len</span><br><span class="line">SRR8651554_1.fastq.gz  FASTQ   DNA   6,383,147  957,472,050      150      150      150</span><br><span class="line">SRR8651554_2.fastq.gz  FASTQ   DNA   6,383,147  957,472,050      150      150      150</span><br></pre></td></tr></table></figure>

<p>如果想统计fastq文件每条序列ATCG四种碱基组成以及质量值分布，可以使用seqtk comp工具来完成。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">seqtk comp SRR8651554_1.fastq.gz SRR8651554_2.fastq.gz</span><br></pre></td></tr></table></figure>

<p>如果按照位点进行统计，例如统计第一个位点所有序列ATCG以及质量值分布，可以适应seqtk fqchk命令。fqchk的结果可以用来绘制碱基质量以及含量分布图。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">seqtk fqchk SRR8651554_1.fastq.gz</span><br></pre></td></tr></table></figure>

<p>合并文件</p>
<p>如果有多个fastq文件，可以使用seqtk mergerpe进行合并，其实cat或者zcat也可以合并，不过seqtk的合并方式有一些差别，cat是将一个文件追加到另一个文件结尾，seqtk mergerpe是每次取文件一个单位合并。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">seqtk mergepe SRR8651554_1.fastq.gz SRR8651554_2.fastq.gz | head -20</span><br></pre></td></tr></table></figure>

<p>———- END ———-</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/06/10/fastq%E6%96%87%E4%BB%B6%E8%AF%A6%E8%A7%A3/" data-id="ckb8a0z8d000n1lhjd97c06uq" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%BD%91%E7%BB%9C%E6%91%98%E6%8A%84/" rel="tag">网络摘抄</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-首次对阿尔茨海默症进行全基因组范围H3K27ac变化研究" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/06/10/%E9%A6%96%E6%AC%A1%E5%AF%B9%E9%98%BF%E5%B0%94%E8%8C%A8%E6%B5%B7%E9%BB%98%E7%97%87%E8%BF%9B%E8%A1%8C%E5%85%A8%E5%9F%BA%E5%9B%A0%E7%BB%84%E8%8C%83%E5%9B%B4H3K27ac%E5%8F%98%E5%8C%96%E7%A0%94%E7%A9%B6/" class="article-date">
  <time datetime="2020-06-09T18:35:06.000Z" itemprop="datePublished">2020-06-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/06/10/%E9%A6%96%E6%AC%A1%E5%AF%B9%E9%98%BF%E5%B0%94%E8%8C%A8%E6%B5%B7%E9%BB%98%E7%97%87%E8%BF%9B%E8%A1%8C%E5%85%A8%E5%9F%BA%E5%9B%A0%E7%BB%84%E8%8C%83%E5%9B%B4H3K27ac%E5%8F%98%E5%8C%96%E7%A0%94%E7%A9%B6/">首次对阿尔茨海默症进行全基因组范围H3K27ac变化研究</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>##首次对阿尔茨海默症进行全基因组范围H3K27ac变化研究</p>
<p><em>2019-01-14</em></p>
<p>阿尔茨海默症（Alzheimer’s disease, AD），俗称老年痴呆，是一种常见的神经退行性疾病，其发病率随着年龄增长而显著增加。随着全球老龄化进程的加剧，AD患者数量正在急剧增长。</p>
<p><img src="https://zhsh006-1257137335.cos.ap-chengdu.myqcloud.com/2020-06-09-183616.png" alt="img"></p>
<p>近日，英国埃克塞特大学的科学家们首次在全基因组范围研究组蛋白乙酰化与阿尔兹海默症的相关性，为阿尔兹海默症的新型疗法开发提供新的思路。这项成果发表在国际杂志Nature Neuroscience。</p>
<p>作者招募了24名AD患者（平均Braak分期6.00）和23名同年龄轻症对照者（平均Braak分期1.30），对内嗅皮层组织样本进行组蛋白乙酰化修饰(H3K27ac) ChIP-seq，在全基因组范围分析AD患者和对照组的H3K27ac分布差异。</p>
<p>ChIP-seq鉴定了4162个与AD相关的差异乙酰化区域，其中2687个为乙酰化下调区域，1475个为乙酰化上调区域。</p>
<p><img src="https://zhsh006-1257137335.cos.ap-chengdu.myqcloud.com/2020-06-09-183617.png" alt="img"></p>
<p>AD组和对照组根据差异H3K27ac修饰（上调和下调）基本能聚类到不同的group。</p>
<p><img src="https://zhsh006-1257137335.cos.ap-chengdu.myqcloud.com/2020-06-09-183621.png" alt="img"></p>
<p>前十个乙酰化上调最显著的区域中，作者发现有一个区域靠近编码Tau蛋白的基因（MAPT），Tau蛋白影响微管蛋白的组装和稳定，是神经系统中重要的蛋白、与AD的病理非常相关，此外与AD相关的基因如PSEN1、PSEN2）邻近区域也发现了差异（上调）的乙酰化修饰。而在前十个乙酰化下调最显著的区域中，作者则注意到了另一个重要的AD相关蛋白基因——APP，在APP下游约100bp处有显著的差异乙酰化修饰。APP基因编码β-淀粉样蛋白的前体，促进淀粉样斑块形成。</p>
<p><img src="https://zhsh006-1257137335.cos.ap-chengdu.myqcloud.com/2020-06-09-183619.png" alt="img"></p>
<p>差异上调乙酰化修饰基因富集到AD相关神经病理功能，如β样淀粉蛋白新陈代谢、缺氧应答等，差异下调基因则富集到突触、GABA受体活性等，与神经传递相关。</p>
<p>H3K27ac通常发挥促进基因表达的作用，被认为是基因激活的标记。这项研究中，作者也发现了一些AD相关的差异乙酰化基因，其表达量受到乙酰化的影响。如RGCC和PIM3基因附近区域乙酰化上调，基因表达量也显著上调。在位于乙酰化下调区域附近的基因，如GPR22、KMO，则表达量下调。这些基因表达量与乙酰化成正相关，但也有一些基因的表达量与乙酰化修饰无明显相关性，如MAPT。</p>
<p><img src="https://zhsh006-1257137335.cos.ap-chengdu.myqcloud.com/2020-06-09-183620.png" alt="img"></p>
<p>这项研究在全基因组范围找到了大量与AD相关的差异差异乙酰化修饰基因 ，这些基因与已知的AD遗传风险基因（如MAPT, PSEN1, PSEN2, APP, TOMM40, CR1）有很大重叠。乙酰化修饰H3K27ac的变化是阿尔兹海默症发生的重要影响因素，对H3K27ac的研究有助于理解阿尔兹海默症发生机制和进程原因。</p>
<p><img src="https://zhsh006-1257137335.cos.ap-chengdu.myqcloud.com/2020-06-09-183618.png" alt="image-20191228205905864"></p>
<p><inter>内嗅皮层</inter></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/06/10/%E9%A6%96%E6%AC%A1%E5%AF%B9%E9%98%BF%E5%B0%94%E8%8C%A8%E6%B5%B7%E9%BB%98%E7%97%87%E8%BF%9B%E8%A1%8C%E5%85%A8%E5%9F%BA%E5%9B%A0%E7%BB%84%E8%8C%83%E5%9B%B4H3K27ac%E5%8F%98%E5%8C%96%E7%A0%94%E7%A9%B6/" data-id="ckb8a0z8a000f1lhj140u6n20" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%BD%91%E7%BB%9C%E6%91%98%E6%8A%84/" rel="tag">网络摘抄</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-ChIP-seq基础入门" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/06/10/ChIP-seq%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8/" class="article-date">
  <time datetime="2020-06-09T18:34:23.000Z" itemprop="datePublished">2020-06-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/06/10/ChIP-seq%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8/">ChIP-seq基础入门</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>理解ChIP-Seq</strong></p>
<p>到了目前这个水平，我学习新的高通量数据分析流程时已经不再考虑代码应该如何写的问题了。我更多要去考虑一个技术的目的和意义。</p>
<p>转录组主要研究的问题是基因在不同情况下的差异表达以及RNA结构变化等，而表观组研究的问题是在基因序列不变的情况下，基因的表达、调控和性状发生了<strong>可遗传变化</strong>的分子机制。也就是相同的DNA, RNA，蛋白质经过一定的修饰后会使得生物性状发生了改变。</p>
<p>ChIP-Seq仅仅是第一个表观遗传学领域比较成熟的技术而已，目前还有很多其他的技术，比如说</p>
<ul>
<li>DNA修饰: DNA甲基化免疫共沉淀技术（MeDIP), 目标区域甲基化，全基因组甲基化（WGBS)，氧化-重亚硫酸盐测序（oxBS-Seq), TET辅助重亚硫酸盐测序（TAB-Seq）</li>
<li>RNA修饰: RNA甲基化免疫共沉淀技术（MeRIP)</li>
<li>蛋白质与核酸相互作用： RIP-Seq, ChIP-Seq, CLIP-Seq</li>
<li>还有最近比较火的ATAC-Seq</li>
</ul>
<p>2013年PNAS上面有一篇文章叫做 <em><a href="http://www.pnas.org/content/110/18/7101.long" target="_blank" rel="noopener">Epigenetics: Core misconcept</a></em> 讲了几点关于表观遗传学,大家的理解错误的地方。</p>
<p>本次主要是分析ChIP-Seq的高通量测序结果，因此，先介绍什么是ChIP-Seq.</p>
<p>所谓的ChIP-Seq其实就是把ChIP实验做完得到的DNA不仅仅用来跑胶，还送去高通量测序了。重点在于ChIP，也就是染色体免疫共沉淀（Chromatin Immunoprecipitation）是用来解决什么科学问题的。毕竟数据分析不是目的，它只是解决问题的一种手段。</p>
<blockquote>
<p>ChIP被用来研究细胞内DNA与蛋白质相互作用，具体来说就是确定特定蛋白（如转录因子）是否结合特定基因组区域（如启动子或其它DNA结合位点）——可能定义顺反组。ChIP还被用来确定基因组上与组蛋白修饰相关的特定位点（即组蛋白修饰酶类的靶标） - 来自维基百科。</p>
</blockquote>
<p>ChIP的实验我从来没有做过，所以只能从网上找来大致的流程，简单分为</p>
<p>第一步： 将蛋白交联到DNA上。 也就是保证蛋白和DNA能够结合，找到互作位点。</p>
<p>第二步： 通过超声波剪切DNA链。</p>
<p>第三步： 加上附上抗体的磁珠用于免疫沉淀靶蛋白。抗体很重要</p>
<p>第四步： 接触蛋白交联；纯化DNA</p>
<p><a href="https://plobimage.ybzhao.com/wp-content/uploads/2019/12/1576381019-8831-2013053-d09d27cbc6fa4c82.png" target="_blank" rel="noopener"><img src="https://zhsh006-1257137335.cos.ap-chengdu.myqcloud.com/2020-06-09-183753.png" alt="ChIP-seq基础入门"></a></p>
<p>实验流程</p>
<p>如果送去测序就是ChIP-Seq, 后续就是对应分析流程，分析分为4步：</p>
<ul>
<li>质量控制， 用到的是FastQC</li>
<li>序列比对，Bowtie2或这BWA</li>
<li>peak calling, 建议用MACS</li>
<li>peak注释， 推荐Y叔的ChIPseeker</li>
</ul>
<h2 id="文章中ChIP-Seq解决的问题"><a href="#文章中ChIP-Seq解决的问题" class="headerlink" title="文章中ChIP-Seq解决的问题"></a>文章中ChIP-Seq解决的问题</h2><p>这部分看看这篇文章想解决什么问题，以及ChIP-Seq解决了什么问题。工具一定要为目的服务。</p>
<p>PS: 可以先去把数据下载了，再看这个部分</p>
<p><strong>文章的研究内容：</strong></p>
<p>PRC1(Polycomb repressive complex 1)与干细胞命运决定有关。PRC1的组成非常的复杂，原文这样写道：</p>
<blockquote>
<p>The protein families that constitute the core of PRC1 contain several members: Cbx (Cbx2, Cbx4, Cbx6, Cbx7, or Cbx8); Ring1A or Ring1B; PHC (PHC1, PHC2, or PHC3); PCGF (PCGF1, PCGF2, PCGF3, PCGF4, PCGF5, or PCGF6); and RYBP or YAF2. Each combination establishes the subtype of PRC1 complexes</p>
</blockquote>
<p>文章想解决的问题是：</p>
<ol>
<li>PRC1复合体两类亚型的全基因组定位</li>
<li>两类复合体调节的基因表达是否有差异</li>
<li>Cbx7，RYBP是否有共同或独特的生物学功能</li>
<li>Cbx7，RYBP在染色质的定位是否是<strong>相互依赖</strong></li>
</ol>
<p>得到的部分答案是：小鼠中有两个互斥的PRC1复合体的变异体，Cbx7和RYBP。Cbx7和RYBP的在基因组上的结合在同一个位置，但是同样互斥，不能共存。 Cbx7用于招募Ring1B结合到染色质，RYBP增加PRC1酶活性。 RYBP所结合的基因，有着较低水平Ring1B和H2AK119ub的水平，表达量高于Cbx7结合态。RYBP和Cbx7的在基因位点的结合情况还与代谢调节，细胞周期过程有关。</p>
<p><strong>ChIP的用途：</strong></p>
<p>为了解决PRC1亚型的定位问题， 作者对PRC1复合体的组成Cbx7, Ring1B, RYBP, 以及PRC2的Suz12f分别做了ChIP-Seq. 然后就是画了很多韦恩图看不同蛋白的靶基因的相互关系。还看了不同蛋白在基因的上的位置。</p>
<p><a href="https://plobimage.ybzhao.com/wp-content/uploads/2019/12/1576381019-1895-2013053-5067f5d1f3cf10f0.png" target="_blank" rel="noopener"><img src="https://zhsh006-1257137335.cos.ap-chengdu.myqcloud.com/2020-06-09-183747.png" alt="ChIP-seq基础入门"></a></p>
<p>一般而言，ChIP-Seq基本就是得到上面这些图，根据疑问再找到某一些基因看调控蛋白的结合和定位。本次实战也就是尝试做出这些图。</p>
<p>根据原文，ChIP-Seq的流程如下：</p>
<ul>
<li>先用<strong>Bowtie</strong>（0.12.7）把RYBP, Cbx7, Ring1B, Suz12,和H2AK11Ub的ChIP-Seq产生短读(reads) 比对到小鼠的参考基因组上（NCBIM37），参数允许seed联配时有2个错配。</li>
<li>使用MACS（1.4.1）寻找可能的结合位点，也就是基因组中大量短读片段富集的区域。MACS比较这些区域在对照组和实验组的差异，选择p值等于10e-5作为阈值。 之后PDR低于5%的Cbx7, Ring1B, Suz12和H2AK119ub的peak和PDR低于1%的RYBP的peak结合用于进一步分析</li>
</ul>
<blockquote>
<p>这一步看起来就很复杂，之后会重点进行学习</p>
</blockquote>
<ul>
<li>在基因内部或距离TSS 2.5kb的 peak 被认为是靶基因。 每个TSS附近5Kb区域，并且与一个或多个ChIP-Seq(RYBP,Ring1B, Cbx7, Suz12, H2AK119ub)结果关联，用于计算ChIP-Seq表达谱和全ChIP-Seq覆盖度。</li>
<li>使用BEDtools 计算TSS附近ChIP-Seq表达谱</li>
</ul>
<p>ChIP-Seq数据分析的流程难点在于找到peak，所以peak calling这一阶段的软件选择比较重要，目前常用的是MACS2, 实际分析建议多用几个软件。目前常用的是MACS2, 实际分析建议多用几个软件。</p>
<h2 id="数据下载和质量控制"><a href="#数据下载和质量控制" class="headerlink" title="数据下载和质量控制"></a>数据下载和质量控制</h2><p>这部分下载ChIP-Seq数据，以及小鼠的参考基因组，注释。</p>
<ul>
<li>下载测序数据，并用sratoolkit解压缩文章提供的GEO是GSE42466，可以在<a href="https://www.ncbi.nlm.nih.gov/geo/" target="_blank" rel="noopener">https://www.ncbi.nlm.nih.gov/geo/</a> 检索到对应的数据集</li>
</ul>
<p><a href="https://plobimage.ybzhao.com/wp-content/uploads/2019/12/1576381019-4261-2013053-1f008758943f16f5.png" target="_blank" rel="noopener"><img src="https://zhsh006-1257137335.cos.ap-chengdu.myqcloud.com/2020-06-09-183757.png" alt="ChIP-seq基础入门"></a></p>
<p>GEO</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># 我习惯将数据保存到项目文件夹下的data中 mkdir -p GSE42466&#x2F;data&#x2F;chip-seq cd GSE42466&#x2F;data&#x2F;chip-seq for ((i&#x3D;204;i&lt;&#x3D;209;i++)); do   wget -4 -q ftp:&#x2F;&#x2F;ftp-trace.ncbi.nlm.nih.gov&#x2F;sra&#x2F;sra-instant&#x2F;reads&#x2F;ByStudy&#x2F;sra&#x2F;SRP&#x2F;SRP017&#x2F;SRP017311&#x2F;SRR620$i&#x2F;SRR620$i.sra;   ~&#x2F;miniconda&#x2F;envs&#x2F;biostar&#x2F;bin&#x2F;fastq-dump –split-3 SRR620$i.sra; done &amp;</span><br></pre></td></tr></table></figure>

<ul>
<li>下载小鼠参考基因组的索引和注释文件, 这里用常用的mm10</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># 索引大小为3.2GB， 不建议自己下载基因组构建 mkdir referece &amp;&amp; cd reference wget -4 -q ftp:&#x2F;&#x2F;ftp.ccb.jhu.edu&#x2F;pub&#x2F;data&#x2F;bowtie2_indexes&#x2F;mm10.zip unzip mm10.zip</span><br></pre></td></tr></table></figure>

<p>注释文件到<a href="https://genome.ucsc.edu/cgi-bin/hgTables" target="_blank" rel="noopener">https://genome.ucsc.edu/cgi-bin/hgTables</a> 选取保存。</p>
<p><a href="https://plobimage.ybzhao.com/wp-content/uploads/2019/12/1576381019-4057-2013053-d6f72a4f1f69d359.png" target="_blank" rel="noopener"><img src="https://zhsh006-1257137335.cos.ap-chengdu.myqcloud.com/2020-06-09-183750.png" alt="ChIP-seq基础入门"></a></p>
<p>或者用curl进行下载。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl &#39;https:&#x2F;&#x2F;genome.ucsc.edu&#x2F;cgi-bin&#x2F;hgTables?hgsid&#x3D;603641571_MKLxB78UAcjaI3oj5YiFCA0Ms86o&amp;boolshad.hgta_printCustomTrackHeaders&#x3D;0&amp;hgta_ctName&#x3D;tb_refGene&amp;hgta_ctDesc&#x3D;table+browser+query+on+refGene&amp;hgta_ctVis&#x3D;pack&amp;hgta_ctUrl&#x3D;&amp;fbQual&#x3D;whole&amp;fbUpBases&#x3D;200&amp;fbExonBases&#x3D;0&amp;fbIntronBases&#x3D;0&amp;fbDownBases&#x3D;200&amp;hgta_doGetBed&#x3D;get+BED&#39; &gt; mm10_refSeq.bed</span><br></pre></td></tr></table></figure>

<p>得到的fastq文件，一般而言都是上机得到的原始数据，也有可能是经过质量控制的结果，但是无论如何都得自己去检查一下。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">## 需要安装fastqc 和 multiqc # 先获取QC结果 ls *gz | while read id; do fastqc -t 4 $id; done # multiqc multiqc *fastqc.zip --pdf</span><br></pre></td></tr></table></figure>

<p>根据质控结果，发现序列的前后几个碱基质量不好，因此在比对的时候会主动忽略。</p>
<p><a href="https://plobimage.ybzhao.com/wp-content/uploads/2019/12/1576381019-1809-2013053-3630d6c9df566fab.png" target="_blank" rel="noopener"><img src="https://zhsh006-1257137335.cos.ap-chengdu.myqcloud.com/2020-06-09-183754.png" alt="ChIP-seq基础入门"></a></p>
<p>今后，可能会去下载其他实验的数据，还要进行质量控制，所以就写一个Python脚本进行流程化操作。脚本命名为<code>sra2qc.py</code>，保存在我的GitHub上</p>
<h2 id="序列比对"><a href="#序列比对" class="headerlink" title="序列比对"></a>序列比对</h2><p>这一步非常简单， 就是将得到fastq文件用bowtie2比对小鼠参考基因组上，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bowtie2 -p 6 -3 5 --local -x reference&#x2F;mm10 -U ChIP-Seq&#x2F;SRR620204.fastq | ~&#x2F;miniconda3&#x2F;bin&#x2F;samtools sort -O bam -o ..&#x2F;analysis&#x2F;alignment&#x2F;ring1B.bam bowtie2 -p 6 -3 5 --local -x reference&#x2F;mm10 -U ChIP-Seq&#x2F;SRR620205.fastq | ~&#x2F;miniconda3&#x2F;bin&#x2F;samtools sort -O bam -o ..&#x2F;analysis&#x2F;alignment&#x2F;cbx7.bam bowtie2 -p 6 -3 5 --local -x reference&#x2F;mm10 -U ChIP-Seq&#x2F;SRR620206.fastq | ~&#x2F;miniconda3&#x2F;bin&#x2F;samtools sort -O bam -o ..&#x2F;analysis&#x2F;alignment&#x2F;suz12.bam bowtie2 -p 6 -3 5 --local -x reference&#x2F;mm10 -U ChIP-Seq&#x2F;SRR620207.fastq | ~&#x2F;miniconda3&#x2F;bin&#x2F;samtools sort -O bam -o ..&#x2F;analysis&#x2F;alignment&#x2F;RYBP.bam bowtie2 -p 6 -3 5 --local -x reference&#x2F;mm10 -U ChIP-Seq&#x2F;SRR620208.fastq | ~&#x2F;miniconda3&#x2F;bin&#x2F;samtools sort -O bam -o ..&#x2F;analysis&#x2F;alignment&#x2F;IgGold.bam bowtie2 -p 6 -3 5 --local -x reference&#x2F;mm10 -U ChIP-Seq&#x2F;SRR620209.fastq | ~&#x2F;miniconda3&#x2F;bin&#x2F;samtools sort -O bam -o ..&#x2F;analysis&#x2F;alignment&#x2F;IgG.bam</span><br></pre></td></tr></table></figure>

<p>我对比对结果进行了简单的统计，发现比对率其实不太高. 虽然在RNA-Seq是要求80~90%的比对率，但是在ChIP-Seq上，我没有具体了解过。</p>
<table>
<thead>
<tr>
<th align="left">样品</th>
<th align="left">比对到单个区域</th>
<th align="left">比对到多个区域</th>
</tr>
</thead>
<tbody><tr>
<td align="left">ring1B</td>
<td align="left">43.76%</td>
<td align="left">15.81%</td>
</tr>
<tr>
<td align="left">cbx7</td>
<td align="left">39.39%</td>
<td align="left">17.49%</td>
</tr>
<tr>
<td align="left">suz12</td>
<td align="left">48.88%</td>
<td align="left">17.17%</td>
</tr>
<tr>
<td align="left">RYBP</td>
<td align="left">58.76%</td>
<td align="left">28.12%</td>
</tr>
<tr>
<td align="left">IgGold</td>
<td align="left">54.54%</td>
<td align="left">27.21%</td>
</tr>
<tr>
<td align="left">IgG</td>
<td align="left">57.83%</td>
<td align="left">25.45%</td>
</tr>
</tbody></table>
<p>比对的结果，可以打开IGV查看，和RNA-Seq最大的区别在于你能看到明显的峰，这就是peak。这类peak在全基因组上特别的多，我们无法用肉眼直接选择，因此就需要借助专门的工具查找。</p>
<p><a href="https://plobimage.ybzhao.com/wp-content/uploads/2019/12/1576381019-1423-2013053-9d8c55ce9e79892d.png" target="_blank" rel="noopener"><img src="https://zhsh006-1257137335.cos.ap-chengdu.myqcloud.com/2020-06-09-183751.png" alt="ChIP-seq基础入门"></a></p>
<blockquote>
<p>一般ChIP-Seq都需要提供一个对照组，也就是图中IgG。很明显的发现其他实验组有峰的区域在对照组中是没有的。而实验组没有峰的区域，对照组也没有，这样子就能提出背景噪声。</p>
</blockquote>
<h2 id="peak-calling"><a href="#peak-calling" class="headerlink" title="peak calling"></a>peak calling</h2><p>peak calling要用到MACS, 建议用ananconda安装, 因为可以选择合适的Python环境。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda create -n macs python&#x3D;2 source activate macs pip install MACS2</span><br></pre></td></tr></table></figure>

<p>macs2包含一系列的子命令，其中最主要的就是<code>callpeak</code>， 官方提供了使用实例</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">macs2 callpeak -t ChIP.bam -c Control.bam -f BAM -g hs -n test -B -q 0.01</span><br></pre></td></tr></table></figure>

<p>一般而言，我们照葫芦画瓢，按照这个实例替换对应部分就行了，介绍一下各个参数的意义</p>
<ul>
<li>-t: 实验组的输出结果</li>
<li>-c: 对照组的输出结果</li>
<li>-f: -t和-c提供文件的格式，可以是”ELAND”, “BED”, “ELANDMULTI”, “ELANDEXPORT”, “ELANDMULTIPET” (for pair-end tags), “SAM”, “BAM”, “BOWTIE”, “BAMPE” “BEDPE” 任意一个。如果不提供这项，就是自动检测选择。</li>
<li>-g: 基因组大小， 默认提供了hs, mm, ce, dm选项， 不在其中的话，比如说拟南芥，就需要自己提供了。</li>
<li>-n: 输出文件的前缀名</li>
<li>-B: 会保存更多的信息在bedGraph文件中，如fragment pileup, control lambda, -log10pvalue and -log10qvalue scores</li>
<li>-q: q值，也就是最小的PDR阈值， 默认是0.05。q值是根据p值利用BH计算，也就是多重试验矫正后的结果。</li>
<li>-p： 这个是p值，指定p值后MACS2就不会用q值了。</li>
<li>-m: 和MFOLD有关，而MFOLD和MACS预构建模型有关，默认是5：50，MACS会先寻找100多个peak区构建模型，一般不用改，因为你不懂。</li>
</ul>
<blockquote>
<p>原文写到：MACS estimated the FDR by comparing the peaks obtained from the samples with those from the control samples, using the same p value cutoff (10e-5). 估计就是指文章用了q=0.05或0.01</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">macs2 callpeak -c IgGold.bam -t suz12.bam -q 0.05 -f BAM -g mm -n suz12 2&gt; suz12.macs2.log &amp; macs2 callpeak -c IgGold.bam -t ring1B.bam -q 0.05 -f BAM -g mm -n ring1B 2&gt; ring1B.macs2.log &amp; macs2 callpeak -c IgG.bam -t cbx7.bam -q 0.05 -f BAM -g mm -n cbx7 2&gt; cbx7.macs2.log &amp; macs2 callpeak -c IgG.bam -t RYBP.bam -q 0.01 -f BAM -g mm -n RYBP 2&gt;RYBP.macs2.log &amp;</span><br></pre></td></tr></table></figure>

<p>可以看下找到了多个peak，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wc -l *bed   2384 cbx7_summits.bed   8342 ring1B_summits.bed      0 RYBP_summits.bed   7619 suz12_summits.bed</span><br></pre></td></tr></table></figure>

<p>结果显示RYBP无peak，估计是数据上传错误，我们可以下载作者上传的peak数据。此外ring1B我找了8000多个，但是原文是7000个，或许要修改阈值。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget ftp:&#x2F;&#x2F;ftp.ncbi.nlm.nih.gov&#x2F;geo&#x2F;series&#x2F;GSE42nnn&#x2F;GSE42466&#x2F;suppl&#x2F;GSE42466_Suz12_peaks_10.txt.gz gzip -d GSE42466_Suz12_peaks_10.txt.gz mv GSE42466_RYBP_peaks_5.txt RYBP2_summits.bed</span><br></pre></td></tr></table></figure>

<p>结果文件不只是上述提到的一类，还有如下格式：</p>
<ul>
<li>NAME_peaks.xls: 以表格形式存放peak信息，虽然后缀是xls，但其实能用文本编辑器打开，和bed格式类似，但是<strong>以1为基</strong>，而bed文件是<strong>以0为基</strong>.也就是说xls的坐标都要减一才是bed文件的坐标</li>
<li>NAME_peaks.narrowPeak NAME_peaks.broadPeak 类似。后面4列表示为， integer score for display， fold-change，-log10pvalue，-log10qvalue，relative summit position to peak start。内容和NAME_peaks.xls基本一致，适合用于导入R进行分析。</li>
<li>NAME_summits.bed：记录每个peak的peak summits，话句话说就是记录极值点的位置。MACS建议用该文件寻找结合位点的motif。</li>
<li>NAME_model.r，能通过<code>$ Rscript NAME_model.r</code>作图，得到是基于你提供数据的peak模型。</li>
</ul>
<p>这一部分的工作主要是学习MACS2软件使用方法和参数的含义，难度不大。目标是找到候选靶基因。</p>
<h2 id="结果注释和可视化"><a href="#结果注释和可视化" class="headerlink" title="结果注释和可视化"></a>结果注释和可视化</h2><p>当我们得到上一步的输出文件后，下一步就是得到文章的结果。用的是Y叔的ChIPseeker，一个充满故事的R包，搜索一下就能看到Y叔的往事。</p>
<p>ChIPseeker的功能分为三类:</p>
<ul>
<li>注释：提取peak附近最近的基因， 注释peak所在区域</li>
<li>比较：估计ChIP peak数据集中重叠部分的显著性；整合GEO数据集，以便于将当前结果和已知结果比较</li>
<li>可视化： peak的覆盖情况；TSS区域结合的peak的平均表达谱和热图；基因组注释；TSS距离；peak和基因的重叠</li>
</ul>
<p>完全符合我们的需要，都不需要用到<code>bedtools</code>和<code>deeptools</code>。</p>
<p>在正式的工作开始之前，我们需要加载<code>ChIPseeker</code>, 基因组注释包和bed数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># biocLite(&quot;ChIPseeker&quot;) # biocLite(&quot;org.Mm.eg.db&quot;) # biocLite(&quot;TxDb.Mmusculus.UCSC.mm10.knownGene&quot;) library(&quot;ChIPseeker&quot;) # 根据自己存放文章具体地址修改，保证导入的数据是BED格式 ring1B &lt;- readPeakFile(&quot;F:&#x2F;Data&#x2F;ChIP&#x2F;ring1B_peaks.narrowPeak&quot;) cbx7 &lt;- readPeakFile(&quot;F:&#x2F;Data&#x2F;ChIP&#x2F;cbx7_peaks.narrowPeak&quot;) RYBP &lt;- readPeakFile(&quot;F:&#x2F;Data&#x2F;ChIP&#x2F;RYBP2_summits.bed&quot;) suz12 &lt;- readPeakFile(&quot;f:&#x2F;Data&#x2F;ChIP&#x2F;suz12_peaks.narrowPeak&quot;)</span><br></pre></td></tr></table></figure>

<p>得到最基本的peak数据后，我们要做以下事情</p>
<ul>
<li>大量的韦恩图，描述不同蛋白结合基因的关系</li>
<li>不同蛋白在染色体结合位点与TSS的距离</li>
</ul>
<p>为了完成上面说的两件事情，我们需要注释peak，准备TSS所在位置然后把peak比对到这些区域.</p>
<p><strong>注：</strong> 原文提供不同蛋白的交集的基因TSS区域，所以要先做注释。</p>
<p>关于peak注释一定要多说几句：</p>
<ul>
<li>启动子区域目前没有明确定义，一般认为基因起始转录位点的上下游区域是启动子区域，文章认为是TSS2.5 kb 以内都是靶基因</li>
<li>注释有两类，genomic annotation和nearest gene annotation. 前者是研究直接调控对象，后者是做基因表达调控</li>
<li>还有一类注释就是简单看peak上下游的范围的基因</li>
</ul>
<p>根据文章得知需要距离TSS一定距离的注释，以及peak上下5 Kb 的注释</p>
<blockquote>
<p>Genes with a peak within the gene body, or within 2.5 kb from the TSS, were considered to be target genes. An area of 5 kb surrounding each TSS that was associated to one or more ChIP-seq (RYBP, Ring1B, Cbx7, Suz12, or H2AK119ub) was used to calculate the ChIP-seq profile and the whole ChIP-seq coverage.</p>
</blockquote>
<p><code>ChIPseeker</code>负责注释的就是annotatePeak，提供了3类注释方式，符合文章的要求</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">peaks &lt;- list(ring1B, cbx7, RYBP, suz12)  peakAnnoList &lt;- lapply(peaks, annotatePeak, tssRegion&#x3D;c(-2500,2500), TxDb&#x3D;txdb,                         addFlankGeneInfo&#x3D;TRUE, flankDistance&#x3D;5000)</span><br></pre></td></tr></table></figure>

<p>结果可以用as.GRanges或者as.data.frame查看。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">as.GRanges(peakAnnoList[[1]]) as.data.frame(peakAnnoList[[1]])</span><br></pre></td></tr></table></figure>

<p>得到的结果会在原先的bed文件中增加额外的注释信息，你可以和之前导入的数据进行比较，比如说<code>geneId, transcriptId,distanceToTSS,flank_txIds</code>等。这些都保存后续作图所需要的信息。我们可以先看不同蛋白的靶位点的注释情况，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">plotDistToTSS(peakAnnoList)</span><br></pre></td></tr></table></figure>

<p><a href="https://plobimage.ybzhao.com/wp-content/uploads/2019/12/1576381019-4668-2013053-21ce29be71b4c05d.png" target="_blank" rel="noopener"><img src="https://zhsh006-1257137335.cos.ap-chengdu.myqcloud.com/2020-06-09-183748.png" alt="ChIP-seq基础入门"></a></p>
<p>image.png</p>
<p>原文大量的是不同蛋白结合基因的<strong>韦恩图</strong>，我们可以用更有趣的<code>UpSet</code>的点图</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">genes&#x3D; lapply(peakAnnoList, function(i) as.data.frame(i)$geneId) library(UpSetR) upset(fromList(genes))</span><br></pre></td></tr></table></figure>

<p><a href="https://plobimage.ybzhao.com/wp-content/uploads/2019/12/1576381019-4235-2013053-c770aabdc7377930.png" target="_blank" rel="noopener"><img src="https://zhsh006-1257137335.cos.ap-chengdu.myqcloud.com/2020-06-09-183755.png" alt="ChIP-seq基础入门"></a></p>
<p>不同蛋白靶基因的集合关系</p>
<p>UpSet技术适用于多于5个集合表示情况，对于两个蛋白的靶基因的比较，大家更加喜欢韦恩图的。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vennplot(genes[1:2])</span><br></pre></td></tr></table></figure>

<p><a href="https://plobimage.ybzhao.com/wp-content/uploads/2019/12/1576381020-8796-2013053-ce80b1a20b242674.png" target="_blank" rel="noopener"><img src="https://zhsh006-1257137335.cos.ap-chengdu.myqcloud.com/2020-06-09-183752.png" alt="ChIP-seq基础入门"></a></p>
<p>简单的韦恩图</p>
<p>感觉没有原文那么高大上，主要原因就是没有上色，可以自行搜索找合适的软件作图。关于不同蛋白靶基因的集合关系图基本上就是这样子。</p>
<p>下面是根据靶基因间的交集，绘制TSS距离图，比如说四个蛋白的重叠基因。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># 准备TSS区域，然后将peak映射到这些区域，得到tagMatrix fourgenes &lt;- intersect(genes[[1]],intersect(genes[[2]],intersect(genes[[3]],genes[[4]]))) target &lt;- select(txdb, keys&#x3D;fourgenes, columns&#x3D;c(&quot;TXID&quot;,&quot;GENEID&quot;), keytype &#x3D; &quot;GENEID&quot;) promoter &lt;- promoters(txdb, upstream &#x3D; 2500, downstream &#x3D; 2500) target_promoter &lt;- promoter[promoter$tx_id %in% target$TXID] tagMatrixList &lt;- lapply(peaks, getTagMatrix, window&#x3D;target_promoter) plotAvgProf(tagMatrixList , xlim &#x3D; c(-3000,2999))</span><br></pre></td></tr></table></figure>

<p><a href="https://plobimage.ybzhao.com/wp-content/uploads/2019/12/1576381019-1757-2013053-1cd82b9ed2c3e441.png" target="_blank" rel="noopener"><img src="https://zhsh006-1257137335.cos.ap-chengdu.myqcloud.com/2020-06-09-183749.png" alt="ChIP-seq基础入门"></a></p>
<p>TSS距离图</p>
<p>感觉和原图有那么一点像，还可以画个热图</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tagHeatmap(tagMatrixList, xlim&#x3D;c(-2999, 3000), color&#x3D;NULL)</span><br></pre></td></tr></table></figure>

<p><a href="https://plobimage.ybzhao.com/wp-content/uploads/2019/12/1576381019-5159-2013053-a7bd32bd59729fed.png" target="_blank" rel="noopener"><img src="https://zhsh006-1257137335.cos.ap-chengdu.myqcloud.com/2020-06-09-183756.png" alt="ChIP-seq基础入门"></a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/06/10/ChIP-seq%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8/" data-id="ckb8a0z86000b1lhjcvgw9l3b" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%BD%91%E7%BB%9C%E6%91%98%E6%8A%84/" rel="tag">网络摘抄</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-一文了解ATAC-seq" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/06/10/%E4%B8%80%E6%96%87%E4%BA%86%E8%A7%A3ATAC-seq/" class="article-date">
  <time datetime="2020-06-09T18:34:13.000Z" itemprop="datePublished">2020-06-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/06/10/%E4%B8%80%E6%96%87%E4%BA%86%E8%A7%A3ATAC-seq/">一文了解ATAC-seq</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Assay for Transposase-Accessible Chromatin with highthroughput sequencing（ATAC-Seq）即利用转座酶探究可接近性染色质高通量测序技术。通俗来说就是利用转座酶来获取开放性染色质，再通过高通量测序及生物信息学分析来挖掘相关基因信息，以此探究生物学相关问题。</p>
<p><a href="https://plobimage.ybzhao.com/wp-content/uploads/2018/09/1536287182-8102-1-1P60G42G21a.jpg" target="_blank" rel="noopener"><img src="https://zhsh006-1257137335.cos.ap-chengdu.myqcloud.com/2020-06-09-183715.jpg" alt="一文了解ATAC-seq"></a></p>
<p><strong>Q：为什么研究染色质开放区域？</strong></p>
<p>A：染色质分为常染色质和异染色质，在结构上常染色质折叠压缩程度低，处于伸展状态，DNA复制，基因转录都发生在DNA的致密高级结构变为松散的状态；这部分打开的染色质，就叫开放染色质（open chromatin）。而打开的染色质，就有足够的区域允许一些调控蛋白（比如转录因子和辅因子）过来与之相结合。而染色质的这种特性，就叫做染色质的可接近性（chromatin accessibility）。通过研究细胞特定状态下开放的染色质区域可以在DNA水平上了解其转录调控。</p>
<p><strong>Q：如何寻找开放的染色质区域？</strong></p>
<p>A：传统使用的的实验方法主要是有MNase-seq和DNase-seq ，这两种实验方法的主要思路是：染色质变得开放，就意味着DNA和组蛋白的聚集程度降低，就会有一部分DNA暴露出来。而一旦失去了蛋白质的保护，这部分DNA就可以被DNA酶（MNase或DNase I）所切割。然后，我们再把切割完的DNA拿来测序，和已知的全基因组序列相比较，就能发现被切割的是哪些序列，没有被切掉的基因序列又在哪里，就知道开放的染色质区域在哪里了。不过，这两个方法有明显的缺陷，即耗时费力与重复性差。虽然FAIRE-seq 不依赖酶和抗体，但其检测背景较高，测序信噪比低，甲醛交联时间不好把握等缺陷，限制其使用范围。</p>
<p><a href="https://plobimage.ybzhao.com/wp-content/uploads/2018/09/1536287184-9010-1-1P60G42J4121.png" target="_blank" rel="noopener"><img src="https://zhsh006-1257137335.cos.ap-chengdu.myqcloud.com/2020-06-09-183717.png" alt="一文了解ATAC-seq"></a></p>
<center> 图1 ATAC-seq原理示意图</center>

<p><strong>Q：有什么新技术方法来研究开放染色质？</strong></p>
<p>A：新推出的ATAC-seq利用Tn5转座酶（DNA转座，是一种把DNA序列从染色体的一个区域搬运到另外一个区域的现象，这一过程就由转座酶参与完成。Tn5转座酶：“标签片段化工具”，Tn5转座体可将其衔接子负载整合到可接近的染色质区域，而空间位阻较不可接近的染色质使得转座不可能发生。）人为将将携带已知DNA序列标签的转座复合物，加入到细胞核中，再利用已知序列的标签进行PCR建库测序，就知道哪些区域是开放染色质了。ATAC-seq出来的结果，和传统方法出来的结果具有很强的一致性，同时也和ChIP-seq有较高的吻合程度。而相比较而言，ATAC-seq的重复性，比MNase-seq和DNase-seq的更强，操作起来也更加简便，而且只需要很少的细胞/组织量，同时测序信号更加好。目前已经成为研究染色质开放性首选的技术方法。</p>
<p><a href="https://plobimage.ybzhao.com/wp-content/uploads/2018/09/1536287184-2735-1-1P60G42Q5H1.jpg" target="_blank" rel="noopener"><img src="https://zhsh006-1257137335.cos.ap-chengdu.myqcloud.com/2020-06-09-183716.jpg" alt="一文了解ATAC-seq"></a></p>
<center>图2 不同实验方法获得开放性染色质分析的示意图</center>



<p><strong>Q：ATAC-seq主要优势是什么？</strong></p>
<p>A：面对现实需求ATAC-seq有以下四个方面的强大优势：</p>
<ul>
<li><p>灵敏性高：低细胞起始量（500-50000个）；</p>
</li>
<li><p>操作简单，耗时短；</p>
</li>
<li><p>实验重复性好：技术重复间表现出非常好的可重复性( R = 0.98) ，并与DHs 测序数据间也有着较好的一致性(R＞0.79)；</p>
</li>
<li><p>能同时揭示开放染色质的基因组位置，DNA结合蛋白，转录结合位点的相互作用</p>
</li>
</ul>
<p>  <a href="https://plobimage.ybzhao.com/wp-content/uploads/2018/09/1536287186-2425-1-1P60G42S2Z4.png" target="_blank" rel="noopener"><img src="https://zhsh006-1257137335.cos.ap-chengdu.myqcloud.com/2020-06-09-183719.png" alt="一文了解ATAC-seq"></a></p>
  <center>表1 ATAC-seq与传统方法比较</center>



<p><strong>Q：ATAC-seq能用在那哪些方面？</strong></p>
<p>A：结合ATAC-seq优势以及研究热潮ATAC-seq有以下用途；当然进一步的开发也可能在不久的将来让其使用更加广泛。</p>
<ol>
<li><p>非生物逆境，病虫害，营养，激素等处理前后及动物疾病，转录活性差异。</p>
</li>
<li><p>不同组织，器官转录活性差异，找到组织特异基因和启动子。</p>
</li>
<li><p>利用ATAC-seq技术来研究A、B、D三个亚基因组的转录因子结合位点的差异，从而研究同源基因的表达调控差异。而六倍体与二倍体、四倍体等位基因间调控位点的比较。</p>
</li>
<li><p>通过ATAC-seq定义的open chromatin区域 ，再结合motif 分析，识别哪种转录因子参与了基因表达调控（对于抗体质量不好的TF，尤其有效）</p>
</li>
<li><p>而将ATAC-seq和RNA-seq进行整合研究，将会获得对生物体（动物或植物）中的转录调控机制；宏观分析细胞在该特定时空下整个基因组的调控网络。</p>
</li>
</ol>
<p><strong>Q：ATAC-seq 有哪些缺陷呢？</strong></p>
<p>A：任何技术都有其限制因素，ATAC-seq也不例外；</p>
<ol>
<li><p>Tn5通过插入剪断DNA 并将测序接头连接到剪断的两个DNA 片段的末端，因此对于一个DNA 片段而言，其两端的接头连接是随机的，这便导致同一片段两端的接头有50%的概率是同一接头。而只有连接不同接头的片段才可用于富集扩增及测序，因此，有一半的片段无法利用；</p>
</li>
<li><p>大量剪断的DNA 由于片段过大，无法进行PCR富集;</p>
</li>
<li><p>Tn5 的活性受反应溶液的组成及反应条件影响，仍然需要优化以便提高剪切效果；</p>
</li>
<li><p>ATAC-seq在植物细胞中存在以下难点：细胞壁的存在，叶绿体、线粒体等细胞器的污染，缺少稳定遗传的细胞系;</p>
</li>
</ol>
<p><strong>Q：现在用ATAC-seq发表文章多么？</strong> </p>
<p>A：ATAC-seq在2013年问世，文章数量逐年增加，2018年刚开年就已经有近10篇文章已经发表；把握机会让您的研究如虎添翼。</p>
<p><a href="https://plobimage.ybzhao.com/wp-content/uploads/2018/09/1536287184-1802-1-1P60G43022109.png" target="_blank" rel="noopener"><img src="https://zhsh006-1257137335.cos.ap-chengdu.myqcloud.com/2020-06-09-183718.png" alt="一文了解ATAC-seq"></a></p>
<p><strong>Q：ATAC-seq文章推荐</strong></p>
<p>A：ATAC-seq文章数量不断增长，希望下一篇就是您的杰作。</p>
<p><u><strong><em>[1] Ackermann, A. M., Wang, Z., Schug, J., Naji, A., &amp; Kaestner, K. H. (2016). Integration of ATAC-seq and RNA-seq identifies human alpha cell and beta cell signature genes. Mol Metab, 5(3), 233-244. doi: 10.1016/j.molmet.2016.01.002</em></strong></u></p>
<p>从55岁的男性病人中获取了一种新的食管癌细胞系：MFD-1，采用ATAC-seq方法与经典的食道癌细胞系OE33和人食管上皮细胞HET1A比较差异，进行MFD-1癌细胞特性研究，绘制MFD-1染色质开放位点图谱。和正常上皮细胞相比，MFD-1特异的染色质开放位点显著富集着CTCF、NFY、Meis3 、Nrf2 的motif，且这些位点附近基因富集在和上皮癌及消化道肿瘤相关的功能分组内。</p>
<p>结合全基因组测序（WGS）和表达谱测序（RNA-seq）技术，发现细胞系中4 个基因(ABCB1, DOCK2, SEMA5A 和TP53）存在5个突变位点，提供了MFD-1的基因表达特性。说明MFD-1能作为一种代表性的临床前原发性食管癌模式细胞系，可用于对应突变类型的研究。</p>
<p><a href="https://plobimage.ybzhao.com/wp-content/uploads/2018/09/1536287188-6245-1-1P60G43044548.png" target="_blank" rel="noopener"><img src="https://zhsh006-1257137335.cos.ap-chengdu.myqcloud.com/2020-06-09-183716.png" alt="一文了解ATAC-seq"></a></p>
<p><u><strong><em>[2] Tan, L., Ke, Z., Tombline, G., Macoretta, N., Hayes, K., Tian, X. Gorbunova, V. (2017). Naked Mole Rat Cells Have a Stable Epigenome that Resists iPSC Reprogramming. Stem Cell Reports, 9(5), 1721-1734. doi: 10.1016/j.stemcr.2017.10.001</em></strong></u></p>
<p>成年裸鼹鼠skin fibroblasts (NSF)的iPSC诱导率显著低于小鼠mouse skin fibroblasts (MSF)。筛选了12个能提高重编程效率的因子，发现其中的LT（一种能够抑制Rb基因表达的东西）能提高裸鼹鼠的iPSC诱导效率。</p>
<p>此研究首先用组蛋白修饰ChIP-qPCR和组蛋白质谱对比了裸鼹鼠和小鼠组蛋白修饰的差异，又用ATAC-seq查看了开放区的差异。ATAC-seq结果跟前面复杂的组蛋白转录后修饰的结果非常符合ATAC-seq分析结果。</p>
<p>ATAC-seq实验表明：裸鼹鼠中重编程基因的promoter区跟小鼠比起来处于一种都关起来了（more closed）的状态，表达LT之后（LT可以抑制Rb, 提高重编程效率），发现裸鼹鼠这些基因的promoter区又大量开放了（massive opening）。</p>
<p>结论：裸鼹鼠具有更加稳定的表观基因组，这一特征帮助它抵抗脱分化，从而为抗癌和长寿做出了贡献。<a href="https://plobimage.ybzhao.com/wp-content/uploads/2018/09/1536287188-7753-1-1P60G43059D8.png" target="_blank" rel="noopener"><img src="https://zhsh006-1257137335.cos.ap-chengdu.myqcloud.com/2019-12-20-214437.png" alt="一文了解ATAC-seq"></a></p>
<p><strong>Q：ATAC-seq送样标准？</strong></p>
<p>A：ATAC-seq因其限制性因素较少样品准备也变得简单，以下是其送样标准：</p>
<table>
<thead>
<tr>
<th><strong>样品类型</strong></th>
<th align="center">样品量</th>
<th>样品处理</th>
<th>运输方式</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td><strong>细胞系</strong></td>
<td align="center">＞5×104个</td>
<td>取样后直接速冻</td>
<td>干冰寄送（3d内）</td>
<td>细胞是完整的且为均匀的单细胞悬液；</td>
</tr>
<tr>
<td><strong>动物组织</strong></td>
<td align="center">≥1g</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><strong>植物组织</strong></td>
<td align="center">≥1g</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><strong>真核微生物</strong></td>
<td align="center">需和老师协商</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<ol>
<li>样本要求</li>
</ol>
<p>1)新鲜细胞</p>
<p>细胞培养于培养瓶中，在运输前灌满培养基，室温运输。</p>
<p>具体要求为：细胞数量&gt;20 万，细胞状态良好无污染。</p>
<p>2)冻存细胞</p>
<p>培养细胞进行计数，按照5*104个细胞每管进行分装，分装好的细胞 4℃、500 G 离心 5 min；PBS洗涤，4℃、500G离心5min。小心吸去全部液体，将细胞沉淀用液氮进行速冻，干冰运输。</p>
<p>具体要求:细胞严格按照 5*104每管分装，每个样品分装三管。</p>
<p>3)动物组织</p>
<p>新鲜的组织取到1.5ml EP管中，用液氮进行速冻，干冰运输。 动物组织质量应当&gt;1g，并且组织新鲜无降解，无结缔组织或血块存在。</p>
<p>4)植物组织</p>
<p>选取新鲜的植物组织，用液氮进行速冻，干冰运输。 尽量选取新鲜的嫩叶或者花等作为实验样品，样品量尽可能多;样品应保证新鲜。</p>
<ol start="2">
<li>样品包装</li>
</ol>
<p>所有的容器应当用parafilm进行封口</p>
<p>注意：</p>
<p>生物学重复：2-4次</p>
<p>测序深度：100 M以上，保证50 M 有效reads</p>
<p>样本要求：ATAC-seq实验对于细胞数量和质量有着严格的要求，实验的成败很大程度上细胞的状态以及细胞量与Tn5转座酶的比例。若细胞状态差，污染严重，那么测序的结果会出现很大的偏差。若果细胞数量过少，过多的酶会进行过度的切割，导致测序结果异常；而细胞量过多可能导致切割不充分，使得原本应当测到的开放区域未被测出。</p>
<p><strong>Q：ATAC-seq-数据交付及周期</strong></p>
<p>A：ATAC-seq数据质控标准：</p>
<p>①采用PE50测序策略数据量满足要求clean data≥50M clean reads（特别注意研究转录因子测序数据量需要≥200M）；</p>
<p>②Q20 ≥ 80% ;</p>
<p>交付周期：45个工作日（样本数≤20个）；大项目周期需评估沟通。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/06/10/%E4%B8%80%E6%96%87%E4%BA%86%E8%A7%A3ATAC-seq/" data-id="ckb8a0z8c000j1lhj704zbtbf" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%BD%91%E7%BB%9C%E6%91%98%E6%8A%84/" rel="tag">网络摘抄</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/">&amp;laquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/">Next &amp;raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux%E8%BD%AF%E4%BB%B6/" rel="tag">Linux软件</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BD%91%E7%BB%9C%E6%91%98%E6%8A%84/" rel="tag">网络摘抄</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Linux%E8%BD%AF%E4%BB%B6/" style="font-size: 10px;">Linux软件</a> <a href="/tags/%E7%BD%91%E7%BB%9C%E6%91%98%E6%8A%84/" style="font-size: 20px;">网络摘抄</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">March 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">November 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">June 2020</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/03/15/%E8%AF%B7%E9%97%AETransit-amplifying-cells/">请问Transit_amplifying_cells</a>
          </li>
        
          <li>
            <a href="/2021/03/15/%E4%BA%BA%E7%A5%9E%E7%BB%8F%E5%B9%B2%E7%BB%86%E8%83%9E%E7%B3%BBCTX0E03/">人神经干细胞系CTX0E03</a>
          </li>
        
          <li>
            <a href="/2021/03/15/%E6%85%A2%E7%97%85%E6%AF%92/">慢病毒</a>
          </li>
        
          <li>
            <a href="/2021/03/15/%E5%A6%82%E4%BD%95%E4%BC%98%E5%8C%96%E6%82%A8%E7%9A%84%E7%94%B5%E7%A9%BF%E5%AD%94%E5%AE%9E%E9%AA%8C%EF%BC%9F-%E5%BF%83%E5%BE%97%E7%82%B9%E8%AF%84/">如何优化您的电穿孔实验？[心得点评]</a>
          </li>
        
          <li>
            <a href="/2021/03/15/Sigma%E9%80%80%E5%87%BAmiRNA%E9%95%BF%E6%95%88%E6%8A%91%E5%88%B6%E5%89%82/">Sigma退出miRNA长效抑制剂</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>